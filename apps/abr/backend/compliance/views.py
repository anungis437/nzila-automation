"""
DRF viewsets for compliance app.
Auto-generated by Nzila Code Generator â€” 2026-02-17
"""
from rest_framework import viewsets, permissions, filters
from django_filters.rest_framework import DjangoFilterBackend
from .models import (RiskScoreHistory, OrganizationRiskHistory, EvidenceBundles, EvidenceBundleComponents, EvidenceBundlePolicyMappings, EvidenceBundleTimeline)
from .serializers import (RiskScoreHistorySerializer, OrganizationRiskHistorySerializer, EvidenceBundlesSerializer, EvidenceBundleComponentsSerializer, EvidenceBundlePolicyMappingsSerializer, EvidenceBundleTimelineSerializer)


class RiskScoreHistoryViewSet(viewsets.ModelViewSet):
    """API endpoint for RiskScoreHistory operations."""
    queryset = RiskScoreHistory.objects.all()
    serializer_class = RiskScoreHistorySerializer
    permission_classes = [permissions.IsAuthenticated]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    search_fields = ['department', 'location']
    ordering_fields = ['created_at', 'updated_at']
    ordering = ['-created_at']


class OrganizationRiskHistoryViewSet(viewsets.ModelViewSet):
    """API endpoint for OrganizationRiskHistory operations."""
    queryset = OrganizationRiskHistory.objects.all()
    serializer_class = OrganizationRiskHistorySerializer
    permission_classes = [permissions.IsAuthenticated]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    ordering_fields = ['created_at', 'updated_at']
    ordering = ['-created_at']


class EvidenceBundlesViewSet(viewsets.ModelViewSet):
    """API endpoint for EvidenceBundles operations."""
    queryset = EvidenceBundles.objects.all()
    serializer_class = EvidenceBundlesSerializer
    permission_classes = [permissions.IsAuthenticated]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    filterset_fields = ['status']
    search_fields = ['bundle_name', 'bundle_type', 'description', 'tags', 'status']
    ordering_fields = ['created_at', 'updated_at']
    ordering = ['-created_at']


class EvidenceBundleComponentsViewSet(viewsets.ModelViewSet):
    """API endpoint for EvidenceBundleComponents operations."""
    queryset = EvidenceBundleComponents.objects.all()
    serializer_class = EvidenceBundleComponentsSerializer
    permission_classes = [permissions.IsAuthenticated]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    search_fields = ['component_type', 'component_id', 'component_title']
    ordering_fields = ['created_at', 'updated_at']
    ordering = ['-created_at']


class EvidenceBundlePolicyMappingsViewSet(viewsets.ModelViewSet):
    """API endpoint for EvidenceBundlePolicyMappings operations."""
    queryset = EvidenceBundlePolicyMappings.objects.all()
    serializer_class = EvidenceBundlePolicyMappingsSerializer
    permission_classes = [permissions.IsAuthenticated]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    filterset_fields = ['compliance_status']
    search_fields = ['tribunal_case_id', 'tribunal_case_title', 'related_training_id', 'related_training_title', 'policy_reference']
    ordering_fields = ['created_at', 'updated_at']
    ordering = ['-created_at']


class EvidenceBundleTimelineViewSet(viewsets.ModelViewSet):
    """API endpoint for EvidenceBundleTimeline operations."""
    queryset = EvidenceBundleTimeline.objects.all()
    serializer_class = EvidenceBundleTimelineSerializer
    permission_classes = [permissions.IsAuthenticated]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    search_fields = ['event_type', 'event_title', 'event_description', 'related_component_id', 'related_component_type']
    ordering_fields = ['created_at', 'updated_at']
    ordering = ['-created_at']
