"""
Django models for ai_core app.
Auto-generated by Nzila Code Generator â€” 2026-02-17

DO NOT EDIT manually unless you know what you're doing.
Re-run the generator to overwrite.
"""
import uuid
from django.db import models
from django.contrib.postgres.fields import ArrayField
from django.contrib.postgres.search import SearchVectorField

try:
    from pgvector.django import VectorField
except ImportError:
    VectorField = None  # pgvector not installed


class BaseModel(models.Model):
    """Abstract base with standard audit fields."""
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        abstract = True


class OrganizationModel(BaseModel):
    """Abstract base for multi-organization models."""
    organization = models.ForeignKey(
        'auth_core.Organizations',
        on_delete=models.CASCADE,
        related_name='%(class)ss'
    )

    class Meta:
        abstract = True



class ClassificationFeedback(BaseModel):
    """Migrated from sql: 015_ai_training_system.sql"""
    case_title = models.TextField(null=True, blank=True)
    case_text_excerpt = models.TextField(null=True, blank=True)
    reviewed_by = models.UUIDField(null=True, blank=True)
    reviewed_date = models.DateTimeField(null=True, blank=True)
    training_batch_id = models.UUIDField(null=True, blank=True)
    but = models.TextField(null=True, blank=True)

    class Meta:
        db_table = 'classification_feedback'
        verbose_name = 'ClassificationFeedback'
        ordering = ['-created_at']

class TrainingJobs(BaseModel):
    """Migrated from sql: 015_ai_training_system.sql"""
    version = models.TextField(null=True, blank=True)
    provider_job_id = models.TextField(null=True, blank=True)
    fine_tuned_model = models.TextField(null=True, blank=True)
    feedback_ids = models.UUIDField()
    training_data_url = models.TextField(null=True, blank=True)
    validation_data_url = models.TextField(null=True, blank=True)
    completed_at = models.DateTimeField(null=True, blank=True)
    training_log = models.JSONField(default=dict, null=True, blank=True)
    validation_metrics = models.JSONField(default=dict, null=True, blank=True)
    deployed_at = models.DateTimeField(null=True, blank=True)
    deployed_by = models.UUIDField(null=True, blank=True)
    notes = models.TextField(null=True, blank=True)
    error_message = models.TextField(null=True, blank=True)

    class Meta:
        db_table = 'training_jobs'
        verbose_name = 'TrainingJobs'
        ordering = ['-created_at']

class AutomatedTrainingConfig(BaseModel):
    """Migrated from sql: 015_ai_training_system.sql"""
    is_enabled = models.BooleanField(default=False)
    schedule_day_of_week = models.IntegerField(null=True, blank=True)
    schedule_hour = models.IntegerField(null=True, blank=True)
    hyperparameters = models.JSONField(default=dict, null=True, blank=True)
    min_validation_accuracy = models.DecimalField(max_digits=5, decimal_places=4, null=True, blank=True, default=0.85)
    last_run_at = models.DateTimeField(null=True, blank=True)
    last_run_job_id = models.UUIDField(null=True, blank=True)

    class Meta:
        db_table = 'automated_training_config'
        verbose_name = 'AutomatedTrainingConfig'
        ordering = ['-created_at']

class CaseEmbeddings(BaseModel):
    """Migrated from sql: 20250108000002_create_embeddings_tables.sql"""
    case_id = models.UUIDField(null=True, blank=True)
    embedding_type = models.CharField(max_length=50)
    updated_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        db_table = 'case_embeddings'
        verbose_name = 'CaseEmbeddings'

class CourseEmbeddings(BaseModel):
    """Migrated from sql: 20250108000002_create_embeddings_tables.sql"""
    course_id = models.UUIDField(null=True, blank=True)
    embedding_type = models.CharField(max_length=50)
    updated_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        db_table = 'course_embeddings'
        verbose_name = 'CourseEmbeddings'

class LessonEmbeddings(BaseModel):
    """Migrated from sql: 20250108000002_create_embeddings_tables.sql"""
    lesson_id = models.UUIDField(null=True, blank=True)
    embedding_type = models.CharField(max_length=50)
    token_count = models.IntegerField(null=True, blank=True)
    updated_at = models.DateTimeField(null=True, blank=True)

    class Meta:
        db_table = 'lesson_embeddings'
        verbose_name = 'LessonEmbeddings'
        constraints = [
            models.UniqueConstraint(fields=['lesson_id', 'embedding_type'], name='unique_lesson_embeddings_lesson_id_embedding_type'),
        ]

class EmbeddingJobs(BaseModel):
    """Migrated from sql: 20250108000002_create_embeddings_tables.sql"""
    processed_items = models.IntegerField(null=True, blank=True)
    failed_items = models.IntegerField(null=True, blank=True)
    batch_size = models.IntegerField(null=True, blank=True)
    metrics = models.JSONField(default=dict, null=True, blank=True)
    completed_at = models.DateTimeField(null=True, blank=True)
    created_at = models.DateTimeField(null=True, blank=True)
    created_by = models.UUIDField(null=True, blank=True)

    class Meta:
        db_table = 'embedding_jobs'
        verbose_name = 'EmbeddingJobs'
        ordering = ['-created_at']