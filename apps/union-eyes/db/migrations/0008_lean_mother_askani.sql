DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
$ BEGIN ALTER TABLE "collective_agreements" DROP CONSTRAINT IF EXISTS "collective_agreements_cba_number_unique"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
$;--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
$ BEGIN ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT IF EXISTS "wallet_balance_non_negative"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
$;--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
$ BEGIN ALTER TABLE "clc_sync_log" DROP CONSTRAINT IF EXISTS "clc_sync_log_organization_id_fkey"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
$ BEGIN ALTER TABLE "poll_votes" DROP CONSTRAINT IF EXISTS "poll_votes_tenant_id_tenants_tenant_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "polls" DROP CONSTRAINT IF EXISTS "polls_tenant_id_tenants_tenant_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "survey_answers" DROP CONSTRAINT IF EXISTS "survey_answers_tenant_id_tenants_tenant_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "survey_questions" DROP CONSTRAINT IF EXISTS "survey_questions_tenant_id_tenants_tenant_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "survey_responses" DROP CONSTRAINT IF EXISTS "survey_responses_tenant_id_tenants_tenant_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "surveys" DROP CONSTRAINT IF EXISTS "surveys_tenant_id_tenants_tenant_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "grievance_deadlines" DROP CONSTRAINT IF EXISTS "grievance_deadlines_claim_id_claims_claim_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "grievance_deadlines" DROP CONSTRAINT IF EXISTS "grievance_deadlines_stage_id_grievance_stages_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_stage_id_grievance_stages_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "automation_rules" DROP CONSTRAINT IF EXISTS "automation_rules_org_id_organizations_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_stage_id_grievance_stages_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_stage_id_grievance_stages_id_fk";
--> statement-breakpoint
ALTER TABLE "automation_rules" DROP CONSTRAINT "automation_rules_org_id_organizations_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "automation_rules" DROP CONSTRAINT IF EXISTS "automation_rules_award_type_id_recognition_award_types_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_stage_id_grievance_stages_id_fk";
--> statement-breakpoint
ALTER TABLE "automation_rules" DROP CONSTRAINT "automation_rules_org_id_organizations_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
DO DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_stage_id_grievance_stages_id_fk";
--> statement-breakpoint
ALTER TABLE "automation_rules" DROP CONSTRAINT "automation_rules_org_id_organizations_id_fk";
--> statement-breakpoint
ALTER TABLE "automation_rules" DROP CONSTRAINT "automation_rules_award_type_id_recognition_award_types_id_fk";
--> statement-breakpoint
$ BEGIN ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT IF EXISTS "reward_wallet_ledger_org_id_organizations_id_fk"; EXCEPTION WHEN undefined_object THEN NULL; END DROP TYPE IF EXISTS "public"."negotiation_session_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_session_type" AS ENUM('opening', 'negotiation', 'caucus', 'conciliation', 'information', 'closing', 'ratification');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."negotiation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."negotiation_status" AS ENUM('scheduled', 'active', 'impasse', 'conciliation', 'tentative', 'ratified', 'rejected', 'strike_lockout', 'completed', 'abandoned');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_status" AS ENUM('draft', 'submitted', 'under_review', 'accepted', 'rejected', 'counter_offered', 'withdrawn', 'superseded');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."proposal_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."proposal_type" AS ENUM('union_demand', 'management_offer', 'joint_proposal', 'mediator_proposal');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."bargaining_team_role" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."bargaining_team_role" AS ENUM('chief_negotiator', 'committee_member', 'researcher', 'note_taker', 'subject_expert', 'observer', 'legal_counsel', 'financial_advisor');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_processor" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_processor" AS ENUM('stripe', 'whop', 'paypal', 'square', 'manual');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_status" AS ENUM('pending', 'paid', 'partial', 'overdue', 'waived', 'refunded', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."transaction_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."transaction_type" AS ENUM('charge', 'payment', 'adjustment', 'refund', 'waiver', 'late_fee');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_method" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_method" AS ENUM('stripe', 'bank_transfer', 'check', 'cash', 'direct_debit', 'payroll_deduction', 'ewallet');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_status" AS ENUM('pending', 'processing', 'completed', 'failed', 'refunded', 'disputed', 'unmatched', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."payment_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."payment_type" AS ENUM('dues', 'strike_fund', 'subscription', 'stipend', 'honorarium', 'rebate', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."reconciliation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."reconciliation_status" AS ENUM('unreconciled', 'pending_review', 'reconciled', 'orphaned', 'disputed');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_status" AS ENUM('active', 'inactive', 'archived', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."account_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."account_type" AS ENUM('asset', 'liability', 'equity', 'revenue', 'expense', 'cost_of_goods_sold', 'other_income', 'other_expense');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."cost_center_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."cost_center_type" AS ENUM('department', 'project', 'location', 'program', 'fund', 'grant', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."notification_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."notification_type" AS ENUM('payment_confirmation', 'payment_failed', 'payment_reminder', 'donation_received', 'stipend_approved', 'stipend_disbursed', 'low_balance_alert', 'arrears_warning', 'strike_announcement', 'picket_reminder', 'claim_update', 'document_update', 'deadline_alert', 'system_announcement', 'security_alert', 'general');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."signature_workflow_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."signature_workflow_status" AS ENUM('draft', 'sent', 'in_progress', 'completed', 'declined', 'cancelled', 'expired', 'voided');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."congress_membership_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."congress_membership_status" AS ENUM('active', 'suspended', 'expired', 'pending');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."employment_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."employment_status" AS ENUM('active', 'inactive', 'on_leave', 'terminated', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."external_hris_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."external_hris_provider" AS ENUM('WORKDAY', 'BAMBOOHR', 'ADP', 'CERIDIAN', 'UKG');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_action_type" AS ENUM('send_email', 'send_sms', 'send_push_notification', 'create_task', 'update_record', 'trigger_webhook', 'escalate', 'run_script', 'send_slack_message');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_condition_operator" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_condition_operator" AS ENUM('equals', 'not_equals', 'greater_than', 'greater_than_or_equal', 'less_than', 'less_than_or_equal', 'contains', 'not_contains', 'starts_with', 'ends_with', 'in', 'not_in', 'is_null', 'is_not_null', 'between', 'regex_match');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_execution_status" AS ENUM('pending', 'running', 'success', 'failed', 'skipped', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_frequency" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_frequency" AS ENUM('once', 'every_occurrence', 'daily_digest', 'hourly_digest', 'rate_limited');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_trigger_type" AS ENUM('schedule', 'event', 'threshold', 'manual');--> statement-breakpoint
CREATE TYPE "public"."campaign_status" AS ENUM('planning', 'active', 'paused', 'completed', 'cancelled', 'archived');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."escalation_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."escalation_status" AS ENUM('pending', 'in_progress', 'escalated', 'resolved', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_action_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_action_type" AS ENUM('send_notification', 'update_field', 'create_record', 'delete_record', 'call_api', 'run_query', 'wait_for_duration', 'wait_for_condition', 'branch_condition', 'loop', 'send_webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_execution_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_execution_status" AS ENUM('pending', 'running', 'paused', 'completed', 'failed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."workflow_trigger_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."workflow_trigger_type" AS ENUM('manual', 'schedule', 'record_created', 'record_updated', 'record_deleted', 'field_changed', 'status_changed', 'deadline_approaching', 'webhook');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."audit_action" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."audit_action" AS ENUM('create', 'update', 'delete', 'sync', 'approve', 'reject', 'void', 'reverse');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."erp_system" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."erp_system" AS ENUM('quickbooks_online', 'sage_intacct', 'xero', 'sap_business_one', 'microsoft_dynamics', 'oracle_netsuite', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_direction" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_direction" AS ENUM('push', 'pull', 'bidirectional');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_sync_type" AS ENUM('full_sync', 'incremental_sync', 'remittance_sync', 'member_update', 'wage_update', 'dispute_update');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."clc_webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."clc_webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'skipped', 'manual_review');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."engagement_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."engagement_type" AS ENUM('like', 'comment', 'share', 'retweet', 'reply', 'reaction', 'mention', 'tag');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_account_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_account_status" AS ENUM('active', 'expired', 'disconnected', 'rate_limited', 'suspended');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_platform" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_platform" AS ENUM('facebook', 'twitter', 'instagram', 'linkedin', 'youtube', 'tiktok');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_status" AS ENUM('draft', 'scheduled', 'published', 'failed', 'deleted');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."social_post_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."social_post_type" AS ENUM('text', 'image', 'video', 'link', 'carousel', 'story', 'reel');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_category" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_category" AS ENUM('bug_report', 'feature_request', 'technical_support', 'account_issue', 'billing_question', 'data_issue', 'performance', 'security_concern', 'training_request', 'other');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_priority" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_priority" AS ENUM('low', 'medium', 'high', 'urgent', 'critical');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_source" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_source" AS ENUM('email', 'web_form', 'phone', 'chat', 'internal', 'api');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."ticket_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."ticket_status" AS ENUM('open', 'in_progress', 'waiting_customer', 'waiting_internal', 'resolved', 'closed', 'cancelled');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_provider" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_provider" AS ENUM('workday', 'bamboohr', 'adp', 'ceridian_dayforce', 'ukg_pro', 'quickbooks', 'xero', 'sage_intacct', 'freshbooks', 'wave', 'sunlife', 'manulife', 'blue_cross', 'green_shield', 'canada_life', 'otpp', 'cpp_qpp', 'provincial_pension', 'linkedin_learning', 'udemy', 'coursera', 'slack', 'microsoft_teams', 'sharepoint', 'google_drive', 'dropbox', 'custom');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."integration_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."integration_type" AS ENUM('hris', 'accounting', 'insurance', 'pension', 'lms', 'communication', 'document_management', 'calendar', 'social_media', 'payment');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."sync_type" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."sync_type" AS ENUM('full', 'incremental', 'real_time');--> statement-breakpoint
DROP TYPE IF EXISTS "public"."webhook_status" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."webhook_status" AS ENUM('received', 'processing', 'processed', 'failed', 'ignored');--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public"."organization_users" (
	"organization_user_id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"permissions" jsonb DEFAULT '[]'::jsonb,
	"is_active" boolean DEFAULT true,
	"is_primary" boolean DEFAULT false,
	"invited_by" varchar(255),
	"invited_at" timestamp with time zone,
	"joined_at" timestamp with time zone,
	"last_access_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grievance_approvals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"transition_id" uuid NOT NULL,
	"approver_user_id" varchar(255) NOT NULL,
	"approver_role" varchar(50),
	"action" varchar(20) NOT NULL,
	"reviewed_at" timestamp with time zone DEFAULT now(),
	"comment" text,
	"rejection_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_proposals" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"proposal_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"proposal_type" "proposal_type" NOT NULL,
	"status" "proposal_status" DEFAULT 'draft' NOT NULL,
	"related_clause_id" uuid,
	"clause_category" varchar(100),
	"current_language" text,
	"proposed_language" text NOT NULL,
	"rationale" text,
	"estimated_cost" numeric(15, 2),
	"costing_notes" text,
	"union_position" varchar(50),
	"management_position" varchar(50),
	"submitted_date" timestamp with time zone,
	"response_deadline" timestamp with time zone,
	"resolved_date" timestamp with time zone,
	"parent_proposal_id" uuid,
	"superseded_by_id" uuid,
	"attachments" jsonb,
	"internal_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bargaining_team_members" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"member_id" uuid,
	"name" varchar(255) NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"role" "bargaining_team_role" NOT NULL,
	"is_chief" boolean DEFAULT false,
	"organization" varchar(300),
	"title" varchar(200),
	"worksite" varchar(200),
	"is_active" boolean DEFAULT true,
	"start_date" timestamp with time zone DEFAULT now() NOT NULL,
	"end_date" timestamp with time zone,
	"expertise" jsonb,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiation_sessions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"session_number" integer NOT NULL,
	"session_type" "negotiation_session_type" NOT NULL,
	"title" varchar(300) NOT NULL,
	"scheduled_date" timestamp with time zone NOT NULL,
	"scheduled_end_date" timestamp with time zone,
	"actual_start_date" timestamp with time zone,
	"actual_end_date" timestamp with time zone,
	"location" varchar(300),
	"is_virtual" boolean DEFAULT false,
	"meeting_link" text,
	"union_attendees" jsonb,
	"employer_attendees" jsonb,
	"agenda" jsonb,
	"outcomes" jsonb,
	"summary" text,
	"next_steps" text,
	"proposals_discussed" jsonb,
	"bargaining_note_id" uuid,
	"status" varchar(50) DEFAULT 'scheduled',
	"cancelled" boolean DEFAULT false,
	"cancellation_reason" text,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "negotiations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"expiring_cba_id" uuid,
	"resulting_cba_id" uuid,
	"title" varchar(500) NOT NULL,
	"description" text,
	"union_name" varchar(300) NOT NULL,
	"union_local" varchar(100),
	"employer_name" varchar(300) NOT NULL,
	"bargaining_unit_size" integer,
	"notice_given_date" timestamp with time zone,
	"first_session_date" timestamp with time zone,
	"target_completion_date" timestamp with time zone,
	"tentative_agreement_date" timestamp with time zone,
	"ratification_date" timestamp with time zone,
	"completion_date" timestamp with time zone,
	"status" "negotiation_status" DEFAULT 'scheduled' NOT NULL,
	"current_round" integer DEFAULT 1,
	"total_sessions" integer DEFAULT 0,
	"key_issues" jsonb,
	"strike_vote_passed" boolean DEFAULT false,
	"strike_vote_date" timestamp with time zone,
	"strike_vote_yes_percent" numeric(5, 2),
	"mandate_expiry" timestamp with time zone,
	"estimated_cost" numeric(15, 2),
	"maximum_cost" numeric(15, 2),
	"progress_summary" text,
	"last_activity_date" timestamp with time zone,
	"tags" jsonb,
	"confidentiality_level" varchar(50) DEFAULT 'restricted',
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tentative_agreements" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"negotiation_id" uuid NOT NULL,
	"agreement_number" varchar(50) NOT NULL,
	"title" varchar(500) NOT NULL,
	"clause_category" varchar(100) NOT NULL,
	"agreed_language" text NOT NULL,
	"previous_language" text,
	"related_proposal_ids" jsonb,
	"related_clause_id" uuid,
	"requires_ratification" boolean DEFAULT true,
	"ratified" boolean DEFAULT false,
	"ratification_date" timestamp with time zone,
	"ratification_vote_yes" integer,
	"ratification_vote_no" integer,
	"ratification_notes" text,
	"annual_cost" numeric(15, 2),
	"implementation_cost" numeric(15, 2),
	"costing_approved" boolean DEFAULT false,
	"agreed_date" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_date" timestamp with time zone,
	"union_signed_by" varchar(255),
	"union_signed_date" timestamp with time zone,
	"employer_signed_by" varchar(255),
	"employer_signed_date" timestamp with time zone,
	"attachments" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255) NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_modified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dues_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" uuid NOT NULL,
	"assignment_id" uuid,
	"rule_id" uuid,
	"transaction_type" varchar(50) NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"due_date" date NOT NULL,
	"status" varchar(50) DEFAULT 'pending' NOT NULL,
	"payment_date" timestamp with time zone,
	"payment_method" varchar(50),
	"payment_reference" varchar(255),
	"processor_type" "payment_processor",
	"processor_payment_id" varchar(255),
	"processor_customer_id" varchar(255),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"dues_amount" numeric(10, 2) NOT NULL,
	"cope_amount" numeric(10, 2) DEFAULT '0.00',
	"pac_amount" numeric(10, 2) DEFAULT '0.00',
	"strike_fund_amount" numeric(10, 2) DEFAULT '0.00',
	"late_fee_amount" numeric(10, 2) DEFAULT '0.00',
	"adjustment_amount" numeric(10, 2) DEFAULT '0.00',
	"total_amount" numeric(10, 2) NOT NULL,
	"paid_date" timestamp with time zone,
	"receipt_url" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autopay_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"enabled" boolean DEFAULT false NOT NULL,
	"stripe_customer_id" varchar(255),
	"stripe_payment_method_id" varchar(255),
	"payment_method_last4" varchar(4),
	"payment_method_brand" varchar(50),
	"payment_method_type" varchar(50) DEFAULT 'card',
	"max_amount" numeric(10, 2),
	"frequency" varchar(50) DEFAULT 'monthly',
	"day_of_month" varchar(2) DEFAULT '1',
	"last_payment_date" timestamp,
	"last_payment_amount" numeric(10, 2),
	"last_payment_status" varchar(50),
	"next_payment_date" timestamp,
	"failure_count" varchar(255) DEFAULT '0',
	"last_failure_reason" text,
	"notify_before_payment" boolean DEFAULT true,
	"notify_days_before" varchar(255) DEFAULT '3',
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliation" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_statement_date" timestamp NOT NULL,
	"bank_deposit_id" varchar NOT NULL,
	"deposit_amount" numeric(19, 2) NOT NULL,
	"deposit_currency" varchar(3) DEFAULT 'CAD',
	"status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciled_amount" numeric(19, 2),
	"unmatched_amount" numeric(19, 2),
	"matched_payment_ids" uuid[],
	"unmatched_payment_ids" uuid[],
	"notes" text,
	"reconciliation_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_cycles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(100) NOT NULL,
	"description" text,
	"cycle_type" varchar(50),
	"start_date" timestamp NOT NULL,
	"end_date" timestamp NOT NULL,
	"due_date" timestamp NOT NULL,
	"is_active" boolean DEFAULT true,
	"is_closed" boolean DEFAULT false,
	"closed_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"payment_id" uuid NOT NULL,
	"reason" text NOT NULL,
	"description" text,
	"status" varchar(50) NOT NULL,
	"resolved_amount" numeric(19, 2),
	"resolution_notes" text,
	"resolved_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"filed_by" varchar(255),
	"resolved_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255) NOT NULL,
	"type" "payment_method" NOT NULL,
	"is_default" boolean DEFAULT false,
	"is_active" boolean DEFAULT true,
	"stripe_payment_method_id" varchar,
	"stripe_billing_details" jsonb,
	"processor_type" "payment_processor",
	"processor_method_id" varchar(255),
	"bank_account_token" varchar,
	"bank_account_last_4" varchar(4),
	"expires_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"member_id" varchar(255),
	"amount" numeric(19, 2) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD',
	"type" "payment_type" NOT NULL,
	"status" "payment_status" DEFAULT 'pending' NOT NULL,
	"method" "payment_method" NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_price_id" varchar,
	"stripe_invoice_id" varchar,
	"bank_deposit_id" varchar,
	"check_number" varchar,
	"reference_number" varchar,
	"processor_type" "payment_processor",
	"processor_customer_id" varchar(255),
	"payment_cycle_id" uuid,
	"due_date" timestamp,
	"paid_date" timestamp,
	"reconciliation_status" "reconciliation_status" DEFAULT 'unreconciled',
	"reconciliation_date" timestamp,
	"notes" text,
	"failure_reason" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"stripe_event_id" varchar NOT NULL,
	"event_type" varchar(100) NOT NULL,
	"stripe_payment_intent_id" varchar,
	"stripe_customer_id" varchar,
	"event_data" jsonb NOT NULL,
	"processed" boolean DEFAULT false,
	"processed_at" timestamp,
	"processing_error" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "stripe_webhook_events_stripe_event_id_unique" UNIQUE("stripe_event_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "chart_of_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_number" varchar(50) NOT NULL,
	"account_name" varchar(255) NOT NULL,
	"description" text,
	"type" "account_type" NOT NULL,
	"sub_type" varchar(100),
	"parent_account_id" uuid,
	"status" "account_status" DEFAULT 'active' NOT NULL,
	"normal_balance" varchar(10),
	"is_sub_account" boolean DEFAULT false,
	"allow_transactions" boolean DEFAULT true,
	"require_cost_center" boolean DEFAULT false,
	"require_department" boolean DEFAULT false,
	"require_approval" boolean DEFAULT false,
	"require_invoice" boolean DEFAULT false,
	"is_reconciled_daily" boolean DEFAULT false,
	"last_reconciled_at" timestamp,
	"last_reconciled_balance" numeric(19, 2),
	"gl_code" varchar(50),
	"sap_code" varchar(50),
	"quickbooks_code" varchar(50),
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"opening_balance_date" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cost_centers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"code" varchar(50) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"type" "cost_center_type" NOT NULL,
	"parent_cost_center_id" uuid,
	"manager" varchar(255),
	"status" varchar(50) DEFAULT 'active' NOT NULL,
	"budget_amount" numeric(19, 2),
	"budget_period" varchar(50),
	"budget_start_date" timestamp,
	"budget_end_date" timestamp,
	"warning_threshold" integer DEFAULT 80,
	"external_code" varchar(100),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_account_mappings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"local_account_type" varchar(100) NOT NULL,
	"local_transaction_type" varchar(100) NOT NULL,
	"gl_account_number" varchar(50) NOT NULL,
	"gl_department" varchar(50),
	"gl_cost_center" varchar(50),
	"erp_system_code" varchar(50),
	"erp_account_code" varchar(100),
	"debit_account" varchar(50),
	"credit_account" varchar(50),
	"is_active" boolean DEFAULT true,
	"valid_from" timestamp,
	"valid_to" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_transaction_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"transaction_date" timestamp NOT NULL,
	"transaction_number" varchar(50) NOT NULL,
	"description" text,
	"debit_amount" numeric(19, 2) DEFAULT '0',
	"credit_amount" numeric(19, 2) DEFAULT '0',
	"cost_center_id" uuid,
	"invoice_number" varchar(100),
	"receipt_number" varchar(100),
	"purchase_order_number" varchar(100),
	"source_system" varchar(100),
	"source_record_id" varchar(100),
	"is_posted" boolean DEFAULT false,
	"posted_at" timestamp,
	"posted_by" varchar(255),
	"is_reconciled" boolean DEFAULT false,
	"reconciled_at" timestamp,
	"reconciled_by" varchar(255),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	CONSTRAINT "gl_transaction_log_transaction_number_unique" UNIQUE("transaction_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gl_trial_balance" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"chart_of_accounts_id" uuid NOT NULL,
	"period_end_date" timestamp NOT NULL,
	"opening_balance" numeric(19, 2) DEFAULT '0',
	"debit_total" numeric(19, 2) DEFAULT '0',
	"credit_total" numeric(19, 2) DEFAULT '0',
	"closing_balance" numeric(19, 2) DEFAULT '0',
	"is_finalized" boolean DEFAULT false,
	"finalized_at" timestamp,
	"finalized_by" varchar(255),
	"is_balanced" boolean DEFAULT false,
	"balance" numeric(19, 2),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notification_tracking" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"recipient_id" uuid,
	"type" "notification_type" NOT NULL,
	"status" "notification_status" DEFAULT 'pending' NOT NULL,
	"priority" "notification_priority" DEFAULT 'normal' NOT NULL,
	"subject" text,
	"body" text NOT NULL,
	"html_body" text,
	"template_id" text,
	"template_data" jsonb,
	"provider_id" text,
	"external_message_id" text,
	"action_url" text,
	"action_label" text,
	"sent_at" timestamp,
	"delivered_at" timestamp,
	"failure_reason" text,
	"failure_count" integer DEFAULT 0,
	"last_failure_at" timestamp,
	"metadata" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "member_documents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"user_id" text NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_size" integer NOT NULL,
	"file_type" text NOT NULL,
	"category" text DEFAULT 'General',
	"uploaded_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid,
	"event_type" varchar(100) NOT NULL,
	"event_description" text,
	"ip_address" varchar,
	"user_agent" text,
	"location" jsonb,
	"timestamp" timestamp DEFAULT now() NOT NULL,
	"external_event_id" varchar(255),
	"provider_data" jsonb,
	"signature_id" varchar(255),
	"certificate_info" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_verification" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"signer_id" uuid NOT NULL,
	"signature_hash" varchar(255) NOT NULL,
	"certificate_hash" varchar(255),
	"is_verified" boolean DEFAULT false,
	"verification_method" varchar(100),
	"verification_result" jsonb,
	"certificate_chain" jsonb,
	"certificate_valid_from" timestamp,
	"certificate_valid_to" timestamp,
	"certificate_issuer" text,
	"tamper_detected" boolean DEFAULT false,
	"tamper_details" text,
	"signature_file" varchar(500),
	"created_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signature_workflows" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"document_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"status" "signature_workflow_status" DEFAULT 'draft' NOT NULL,
	"provider" "signature_provider" NOT NULL,
	"external_envelope_id" varchar(255) NOT NULL,
	"external_workflow_id" varchar(255),
	"total_signers" integer NOT NULL,
	"completed_signatures" integer DEFAULT 0,
	"sent_at" timestamp,
	"expires_at" timestamp,
	"completed_at" timestamp,
	"reminder_frequency_days" integer DEFAULT 3,
	"last_reminder_sent_at" timestamp,
	"auto_reminders_enabled" boolean DEFAULT true,
	"workflow_data" jsonb,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"voided_at" timestamp,
	"voided_by" varchar(255),
	"void_reason" text,
	CONSTRAINT "signature_workflows_external_envelope_id_unique" UNIQUE("external_envelope_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "signers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_id" uuid NOT NULL,
	"member_id" varchar(255),
	"email" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"signer_order" integer NOT NULL,
	"status" "signer_status" DEFAULT 'pending' NOT NULL,
	"signed_at" timestamp,
	"declined_at" timestamp,
	"decline_reason" text,
	"external_signer_id" varchar(255),
	"signing_url" varchar(500),
	"signature_image" text,
	"ip_address" varchar,
	"user_agent" text,
	"last_reminder_sent_at" timestamp,
	"reminder_count" integer DEFAULT 0,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "congress_memberships" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"congress_id" uuid NOT NULL,
	"status" "congress_membership_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ended_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_departments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"name" varchar(255) NOT NULL,
	"code" varchar(100),
	"manager_id" varchar(255),
	"manager_name" varchar(255),
	"parent_department_id" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_employees" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"employee_id" varchar(100),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"phone" varchar(50),
	"position" varchar(255),
	"department" varchar(255),
	"location" varchar(255),
	"hire_date" timestamp with time zone,
	"employment_status" "employment_status",
	"work_schedule" varchar(100),
	"supervisor_id" varchar(255),
	"supervisor_name" varchar(255),
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_positions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" "external_hris_provider" NOT NULL,
	"title" varchar(255) NOT NULL,
	"description" text,
	"department" varchar(255),
	"job_profile" varchar(255),
	"effective_date" timestamp with time zone,
	"last_synced_at" timestamp with time zone,
	"is_active" boolean DEFAULT true,
	"raw_data" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"account_name" varchar(500) NOT NULL,
	"account_type" varchar(100) NOT NULL,
	"account_sub_type" varchar(100),
	"classification" varchar(100),
	"current_balance" numeric(15, 2),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_account" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_customers" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"name" varchar(500) NOT NULL,
	"company_name" varchar(500),
	"email" varchar(255),
	"phone" varchar(50),
	"balance" numeric(12, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_customer" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"invoice_number" varchar(255) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"invoice_date" date NOT NULL,
	"due_date" date,
	"total_amount" numeric(12, 2) NOT NULL,
	"balance_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_invoice" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_payments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(500) NOT NULL,
	"payment_date" date NOT NULL,
	"amount" numeric(12, 2) NOT NULL,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_external_payment" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_coverage" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"enrollment_id" varchar(255),
	"employee_id" varchar(255) NOT NULL,
	"plan_id" varchar(255) NOT NULL,
	"plan_type" varchar(100),
	"coverage_amount" numeric(15, 2),
	"deductible" numeric(12, 2),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_coverage_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_dependents" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"date_of_birth" date,
	"relationship" varchar(100),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_dependents_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"plan_id" varchar(255) NOT NULL,
	"plan_name" varchar(500),
	"coverage_level" varchar(100),
	"enrollment_date" date NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"status" varchar(50) NOT NULL,
	"premium" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_enrollments_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_plans" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"plan_name" varchar(500) NOT NULL,
	"plan_type" varchar(100) NOT NULL,
	"coverage_level" varchar(100),
	"effective_date" date NOT NULL,
	"termination_date" date,
	"premium" numeric(12, 2),
	"employer_contribution" numeric(12, 2),
	"employee_contribution" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_plans_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_benefit_utilization" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"policy_id" varchar(255),
	"benefit_type" varchar(100),
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"maximum_benefit" numeric(12, 2),
	"utilized" numeric(12, 2),
	"remaining" numeric(12, 2),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_benefit_utilization_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_beneficiaries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_id" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"first_name" varchar(255) NOT NULL,
	"last_name" varchar(255) NOT NULL,
	"relationship" varchar(100),
	"percentage" integer NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_beneficiaries_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_claims" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"claim_number" varchar(255) NOT NULL,
	"employee_id" varchar(255) NOT NULL,
	"employee_name" varchar(500),
	"policy_number" varchar(255),
	"claim_type" varchar(100),
	"service_date" date,
	"submission_date" date NOT NULL,
	"processed_date" date,
	"claim_amount" numeric(12, 2) NOT NULL,
	"approved_amount" numeric(12, 2),
	"paid_amount" numeric(12, 2),
	"denied_amount" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"denial_reason" text,
	"provider_id" varchar(255),
	"provider_name" varchar(500),
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_claims_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_insurance_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"policy_number" varchar(255) NOT NULL,
	"policy_type" varchar(100),
	"employee_id" varchar(255) NOT NULL,
	"effective_date" date NOT NULL,
	"termination_date" date,
	"coverage_amount" numeric(15, 2),
	"premium" numeric(12, 2),
	"status" varchar(50) NOT NULL,
	"last_synced_at" timestamp,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "external_insurance_policies_unique" UNIQUE("organization_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_channels" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_name" varchar(255) NOT NULL,
	"channel_type" varchar(50),
	"is_archived" boolean DEFAULT false,
	"created_at" timestamp NOT NULL,
	"creator_id" varchar(255),
	"member_count" integer DEFAULT 0,
	"topic" text,
	"description" text,
	"parent_channel_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_channel" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"file_name" varchar(500) NOT NULL,
	"file_type" varchar(50),
	"mime_type" varchar(100),
	"file_size" integer,
	"file_url" text,
	"download_url" text,
	"created_at" timestamp NOT NULL,
	"comment_count" integer DEFAULT 0,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_messages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"channel_id" uuid,
	"user_id" varchar(255),
	"message_text" text,
	"message_type" varchar(50),
	"timestamp" timestamp NOT NULL,
	"thread_id" varchar(255),
	"reply_count" integer DEFAULT 0,
	"reaction_count" integer DEFAULT 0,
	"edited_at" timestamp,
	"deleted_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_message" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_communication_users" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"username" varchar(255),
	"display_name" varchar(255),
	"email" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"title" varchar(255),
	"avatar_url" text,
	"is_bot" boolean DEFAULT false,
	"is_admin" boolean DEFAULT false,
	"is_deleted" boolean DEFAULT false,
	"status_text" varchar(255),
	"status_emoji" varchar(50),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_comm_user" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_completions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"completed_at" timestamp NOT NULL,
	"certificate_id" varchar(255),
	"grade" numeric(5, 2),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_completion" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_courses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_name" varchar(500) NOT NULL,
	"description" text,
	"difficulty_level" varchar(50),
	"duration_minutes" integer,
	"published_at" timestamp,
	"last_updated_at" timestamp,
	"provider" varchar(255),
	"category_id" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_course" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_enrollments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"enrolled_at" timestamp NOT NULL,
	"status" varchar(50) NOT NULL,
	"progress_percentage" integer DEFAULT 0,
	"last_accessed_at" timestamp,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_enrollment" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_learners" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"first_name" varchar(100),
	"last_name" varchar(100),
	"email" varchar(255),
	"profile_url" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_learner" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_lms_progress" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"course_id" varchar(255) NOT NULL,
	"learner_id" varchar(255) NOT NULL,
	"content_id" varchar(255),
	"progress_percentage" integer DEFAULT 0,
	"time_spent_seconds" integer DEFAULT 0,
	"completed_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_lms_progress" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_files" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"library_id" uuid,
	"file_name" varchar(500) NOT NULL,
	"file_url" text,
	"file_size" integer,
	"mime_type" varchar(100),
	"is_folder" boolean DEFAULT false,
	"folder_child_count" integer,
	"created_at" timestamp,
	"created_by" varchar(255),
	"created_by_email" varchar(255),
	"last_modified_at" timestamp,
	"last_modified_by" varchar(255),
	"parent_path" text,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_file" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_libraries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_id" varchar(255),
	"library_name" varchar(255) NOT NULL,
	"library_url" text,
	"description" text,
	"drive_type" varchar(50),
	"created_at" timestamp,
	"created_by" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_library" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_permissions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"file_id" uuid,
	"user_id" varchar(255),
	"group_id" varchar(255),
	"roles" varchar(255),
	"permission_type" varchar(50),
	"scope" varchar(50),
	"granted_to" varchar(255),
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_permission" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_document_sites" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"org_id" uuid NOT NULL,
	"external_provider" varchar(50) NOT NULL,
	"external_id" varchar(255) NOT NULL,
	"site_name" varchar(255) NOT NULL,
	"site_url" text,
	"description" text,
	"created_at" timestamp,
	"last_modified_at" timestamp,
	"last_synced_at" timestamp DEFAULT now() NOT NULL,
	CONSTRAINT "unique_doc_site" UNIQUE("org_id","external_provider","external_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "model_metadata" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"model_type" varchar(50) NOT NULL,
	"version" varchar(20) NOT NULL,
	"accuracy" numeric,
	"trained_at" timestamp DEFAULT now() NOT NULL,
	"parameters" jsonb,
	CONSTRAINT "unique_model" UNIQUE("organization_id","model_type","version")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "analytics_scheduled_reports" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"report_description" text,
	"report_parameters" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"schedule_type" text DEFAULT 'cron' NOT NULL,
	"cron_expression" text,
	"timezone" text DEFAULT 'America/Toronto',
	"next_run_at" timestamp with time zone,
	"last_run_at" timestamp with time zone,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text DEFAULT 'pdf' NOT NULL,
	"include_attachments" boolean DEFAULT true,
	"email_subject" text,
	"email_body" text,
	"is_active" boolean DEFAULT true,
	"run_count" integer DEFAULT 0,
	"last_run_status" text,
	"last_run_error" text,
	"created_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_categories" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"category_name" text NOT NULL,
	"display_name" text NOT NULL,
	"description" text,
	"category_group" text NOT NULL,
	"unit_type" text NOT NULL,
	"calculation_method" text,
	"higher_is_better" boolean DEFAULT true,
	"display_order" integer DEFAULT 0,
	"icon" text,
	"color" text,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "benchmark_categories_category_name_unique" UNIQUE("category_name")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "benchmark_data" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"union_type" text NOT NULL,
	"union_size_bracket" text NOT NULL,
	"region" text NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"sample_size" integer NOT NULL,
	"min_value" numeric(15, 2),
	"max_value" numeric(15, 2),
	"percentile_25" numeric(15, 2),
	"percentile_50" numeric(15, 2),
	"percentile_75" numeric(15, 2),
	"standard_deviation" numeric(15, 2),
	"data_quality_score" integer DEFAULT 100,
	"is_projected" boolean DEFAULT false,
	"confidence_level" text DEFAULT 'high',
	"data_source" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organization_benchmark_snapshots" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"benchmark_category_id" uuid NOT NULL,
	"period_start" date NOT NULL,
	"period_end" date NOT NULL,
	"period_type" text DEFAULT 'monthly' NOT NULL,
	"metric_value" numeric(15, 2) NOT NULL,
	"benchmark_value" numeric(15, 2),
	"variance_from_benchmark" numeric(15, 2),
	"variance_percentage" numeric(8, 2),
	"percentile_rank" integer,
	"performance_indicator" text,
	"previous_period_value" numeric(15, 2),
	"period_over_period_change" numeric(15, 2),
	"period_over_period_percentage" numeric(8, 2),
	"trend_direction" text,
	"data_completeness_percentage" integer DEFAULT 100,
	"calculation_notes" text,
	"calculated_at" timestamp with time zone DEFAULT now(),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "report_delivery_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"scheduled_report_id" uuid,
	"report_name" text NOT NULL,
	"report_type" text NOT NULL,
	"delivery_method" text DEFAULT 'email' NOT NULL,
	"recipients" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"delivery_format" text NOT NULL,
	"file_url" text,
	"file_size_bytes" bigint,
	"file_hash" text,
	"expires_at" timestamp with time zone,
	"status" text DEFAULT 'pending' NOT NULL,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"email_subject" text,
	"email_opened" boolean DEFAULT false,
	"email_opened_at" timestamp with time zone,
	"email_clicked" boolean DEFAULT false,
	"email_clicked_at" timestamp with time zone,
	"generation_time_ms" integer,
	"delivery_time_ms" integer,
	"triggered_by" varchar(255),
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_actions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"action_type" "alert_action_type" NOT NULL,
	"action_config" jsonb NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"execute_if_condition" jsonb,
	"max_retries" integer DEFAULT 3 NOT NULL,
	"retry_delay_seconds" integer DEFAULT 60 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_conditions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"field_path" varchar(255) NOT NULL,
	"operator" "alert_condition_operator" NOT NULL,
	"value" jsonb,
	"condition_group" integer DEFAULT 1 NOT NULL,
	"is_or_condition" boolean DEFAULT false NOT NULL,
	"order_index" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_escalations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"escalation_levels" jsonb NOT NULL,
	"current_level" integer DEFAULT 1 NOT NULL,
	"status" "escalation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"next_escalation_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolved_by" text,
	"resolution_notes" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"triggered_by" "alert_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "alert_execution_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"conditions_met" boolean,
	"conditions_evaluated" jsonb,
	"actions_executed" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_recipients" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"alert_rule_id" uuid NOT NULL,
	"recipient_type" varchar(50) NOT NULL,
	"recipient_id" uuid,
	"recipient_value" varchar(255),
	"delivery_methods" varchar(50)[] DEFAULT '{"email"}' NOT NULL,
	"quiet_hours_start" time,
	"quiet_hours_end" time,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "alert_rules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "alert_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"severity" "alert_severity" DEFAULT 'medium' NOT NULL,
	"frequency" "alert_frequency" DEFAULT 'every_occurrence' NOT NULL,
	"rate_limit_minutes" integer,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"last_executed_at" timestamp with time zone,
	"last_execution_status" "alert_execution_status",
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_definitions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"category" varchar(100),
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"trigger_config" jsonb NOT NULL,
	"workflow_steps" jsonb NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"is_deleted" boolean DEFAULT false NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"last_executed_at" timestamp with time zone,
	"execution_count" integer DEFAULT 0 NOT NULL,
	"success_count" integer DEFAULT 0 NOT NULL,
	"failure_count" integer DEFAULT 0 NOT NULL,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_executions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"workflow_definition_id" uuid NOT NULL,
	"organization_id" uuid NOT NULL,
	"triggered_by" "workflow_trigger_type" NOT NULL,
	"trigger_data" jsonb,
	"status" "workflow_execution_status" DEFAULT 'pending' NOT NULL,
	"current_step" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resumed_at" timestamp with time zone,
	"step_results" jsonb,
	"variables" jsonb,
	"error_message" text,
	"error_details" jsonb,
	"failed_step" integer,
	"total_execution_time_ms" integer,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "card_signing_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"contact_id" uuid NOT NULL,
	"signed_date" date DEFAULT now() NOT NULL,
	"signed_time" time,
	"signing_location" varchar(255),
	"witnessed_by" text,
	"witness_signature_data" jsonb,
	"card_photo_url" text,
	"card_type" varchar(50) DEFAULT 'authorization',
	"card_status" varchar(50) DEFAULT 'valid' NOT NULL,
	"invalidation_reason" text,
	"voluntary_signature" boolean DEFAULT true NOT NULL,
	"signature_obtained_properly" boolean DEFAULT true NOT NULL,
	"date_accurate" boolean DEFAULT true NOT NULL,
	"meets_legal_requirements" boolean,
	"submitted_to_nlrb_clrb" boolean DEFAULT false,
	"submission_date" date,
	"submission_batch_id" uuid,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "employer_responses" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"response_date" date DEFAULT now() NOT NULL,
	"response_type" varchar(50) NOT NULL,
	"response_summary" text NOT NULL,
	"response_severity" varchar(20) DEFAULT 'moderate',
	"meeting_attendance_mandatory" boolean,
	"meeting_location" text,
	"meeting_date_time" timestamp,
	"speakers" text[],
	"talking_points" text[],
	"materials_distributed" text[],
	"material_urls" text[],
	"material_content_summary" text,
	"anti_union_consultant_name" varchar(255),
	"consultant_firm" varchar(255),
	"consultant_tactics" text[],
	"employee_disciplined" boolean DEFAULT false,
	"employee_terminated" boolean DEFAULT false,
	"affected_contact_id" uuid,
	"alleged_reason" text,
	"suspected_retaliation" boolean DEFAULT false,
	"surveillance_reported" boolean DEFAULT false,
	"surveillance_description" text,
	"intimidation_tactics" text[],
	"potential_ulp" boolean DEFAULT false,
	"ulp_filed" boolean DEFAULT false,
	"ulp_case_number" varchar(100),
	"nlrb_clrb_complaint_filed" boolean DEFAULT false,
	"union_counter_strategy" text,
	"union_action_taken" text[],
	"organizers_assigned_response" uuid[],
	"impact_on_campaign" varchar(20),
	"contacts_influenced" integer,
	"estimated_support_lost" numeric(5, 2),
	"evidence_documents" text[],
	"witness_statements" text[],
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "field_organizer_activities" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"organizer_id" text NOT NULL,
	"contact_id" uuid,
	"activity_date" date DEFAULT now() NOT NULL,
	"activity_type" varchar(50) NOT NULL,
	"activity_duration_minutes" integer,
	"activity_location" text,
	"gps_latitude" numeric(10, 8),
	"gps_longitude" numeric(11, 8),
	"offline_mode_used" boolean DEFAULT false,
	"contact_made" boolean DEFAULT false NOT NULL,
	"commitment_level_before" varchar(50),
	"commitment_level_after" varchar(50),
	"card_signed" boolean DEFAULT false,
	"follow_up_needed" boolean DEFAULT false,
	"follow_up_date" date,
	"issues_discussed" text[],
	"concerns_raised" text[],
	"questions_asked" text[],
	"materials_distributed" text[],
	"interaction_quality" varchar(20),
	"likely_to_vote_yes" boolean,
	"willing_to_help_organize" boolean DEFAULT false,
	"potential_leader" boolean DEFAULT false,
	"detailed_notes" text,
	"organizer_observations" text,
	"next_steps" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"synced_at" timestamp with time zone,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "nlrb_clrb_filings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_type" varchar(50) NOT NULL,
	"filing_number" varchar(100),
	"jurisdiction" varchar(50) NOT NULL,
	"filed_date" date NOT NULL,
	"filed_by" varchar(255),
	"employer_notified_date" date,
	"bargaining_unit_description" text NOT NULL,
	"unit_size_claimed" integer NOT NULL,
	"unit_job_classifications" text[],
	"excluded_positions" text[],
	"showing_of_interest_percentage" numeric(5, 2),
	"cards_submitted_count" integer,
	"card_submission_batch_ids" uuid[],
	"status" varchar(50) DEFAULT 'filed' NOT NULL,
	"hearing_date" date,
	"hearing_location" text,
	"hearing_outcome" varchar(50),
	"election_scheduled_date" date,
	"election_location" text,
	"election_type" varchar(50),
	"election_conducted" boolean DEFAULT false,
	"petition_document_url" text,
	"showing_of_interest_document_url" text,
	"hearing_transcripts_url" text,
	"decision_document_url" text,
	"employer_contested" boolean DEFAULT false,
	"employer_objections" text[],
	"employer_counter_arguments" text,
	"employer_representation" varchar(255),
	"decision_date" date,
	"decision_summary" text,
	"unit_approved" boolean,
	"approved_unit_size" integer,
	"approved_job_classifications" text[],
	"appeal_filed" boolean DEFAULT false,
	"appeal_status" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "nlrb_clrb_filings_filing_number_unique" UNIQUE("filing_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaign_milestones" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"milestone_name" varchar(255) NOT NULL,
	"milestone_type" varchar(50) NOT NULL,
	"target_date" date NOT NULL,
	"completed" boolean DEFAULT false,
	"completed_date" date,
	"target_metric" varchar(50),
	"target_value" integer,
	"current_value" integer,
	"progress_percentage" numeric(5, 2),
	"status" varchar(50) DEFAULT 'pending',
	"days_until_deadline" integer,
	"reminder_sent" boolean DEFAULT false,
	"reminder_date" date,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_name" varchar(255) NOT NULL,
	"campaign_code" varchar(50) NOT NULL,
	"target_employer" varchar(255) NOT NULL,
	"workplace_location" text NOT NULL,
	"industry" varchar(100),
	"campaign_type" varchar(50) DEFAULT 'voluntary_recognition' NOT NULL,
	"status" varchar(50) DEFAULT 'planning' NOT NULL,
	"priority" varchar(20) DEFAULT 'medium',
	"estimated_unit_size" integer NOT NULL,
	"target_card_count" integer,
	"cards_signed" integer DEFAULT 0,
	"card_signing_progress" numeric(5, 2),
	"lead_organizer_id" text,
	"organizing_team" uuid[],
	"campaign_start_date" date,
	"target_card_deadline" date,
	"filing_date" date,
	"election_date" date,
	"certification_date" date,
	"campaign_end_date" date,
	"organizing_strategy" text,
	"key_issues" text[],
	"employer_vulnerabilities" text[],
	"union_advantages" text[],
	"contacts_identified" integer DEFAULT 0,
	"contacts_committed" integer DEFAULT 0,
	"house_visits_completed" integer DEFAULT 0,
	"workplace_meetings_held" integer DEFAULT 0,
	"election_eligible_voters" integer,
	"votes_for_union" integer,
	"votes_against_union" integer,
	"challenged_ballots" integer,
	"election_result" varchar(50),
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text,
	"archived_at" timestamp with time zone,
	CONSTRAINT "organizing_campaigns_campaign_code_unique" UNIQUE("campaign_code")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "organizing_contacts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"first_name" varchar(100) NOT NULL,
	"last_name" varchar(100) NOT NULL,
	"email" varchar(255),
	"phone" varchar(20),
	"preferred_contact_method" varchar(20) DEFAULT 'phone',
	"job_title" varchar(100),
	"department" varchar(100),
	"shift" varchar(50),
	"hire_date" date,
	"seniority_years" numeric(4, 1),
	"work_location" varchar(255),
	"supervisor" varchar(100),
	"immediate_coworkers" text[],
	"influence_level" varchar(20) DEFAULT 'low',
	"commitment_level" varchar(50) DEFAULT 'unknown' NOT NULL,
	"union_sentiment" varchar(20),
	"card_signed" boolean DEFAULT false,
	"card_signed_date" date,
	"willing_to_organize" boolean DEFAULT false,
	"issues_concerned_about" text[],
	"first_contact_date" date,
	"last_contact_date" date,
	"total_contacts" integer DEFAULT 0,
	"house_visit_completed" boolean DEFAULT false,
	"house_visit_date" date,
	"likely_to_vote_yes" boolean,
	"employer_loyalist" boolean DEFAULT false,
	"potential_risks" text,
	"notes" text,
	"tags" text[],
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text,
	"updated_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "union_representation_votes" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid NOT NULL,
	"filing_id" uuid,
	"vote_date" date NOT NULL,
	"vote_type" varchar(50) NOT NULL,
	"voting_method" varchar(50),
	"eligible_voters" integer NOT NULL,
	"ballots_cast" integer NOT NULL,
	"voter_turnout_percentage" numeric(5, 2),
	"votes_for_union" integer DEFAULT 0 NOT NULL,
	"votes_against_union" integer DEFAULT 0 NOT NULL,
	"challenged_ballots" integer DEFAULT 0,
	"void_ballots" integer DEFAULT 0,
	"union_vote_percentage" numeric(5, 2),
	"result" varchar(50) NOT NULL,
	"certification_issued" boolean DEFAULT false,
	"certification_date" date,
	"vote_breakdown_by_department" jsonb,
	"vote_breakdown_by_shift" jsonb,
	"union_filed_objections" boolean DEFAULT false,
	"employer_filed_objections" boolean DEFAULT false,
	"objections_summary" text,
	"objections_resolved" boolean,
	"objections_resolution" text,
	"recount_requested" boolean DEFAULT false,
	"recount_date" date,
	"recount_result" varchar(50),
	"certification_number" varchar(100),
	"bargaining_unit_certified" text,
	"union_representative_name" varchar(255),
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_blocks" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"block_type" text NOT NULL,
	"category" text,
	"content" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"styles" jsonb DEFAULT '{}'::jsonb,
	"is_reusable" boolean DEFAULT false,
	"thumbnail_url" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_media_library" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"file_name" text NOT NULL,
	"file_url" text NOT NULL,
	"file_type" text NOT NULL,
	"mime_type" text NOT NULL,
	"file_size" integer NOT NULL,
	"width" integer,
	"height" integer,
	"alt_text" text,
	"caption" text,
	"tags" text[],
	"folder" text DEFAULT '/',
	"uploaded_by" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_navigation_menus" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"location" text NOT NULL,
	"items" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_pages" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"template_id" uuid,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"meta_description" text,
	"meta_keywords" text[],
	"og_image" text,
	"parent_page_id" uuid,
	"content" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"status" text DEFAULT 'draft' NOT NULL,
	"published_at" timestamp with time zone,
	"scheduled_for" timestamp with time zone,
	"view_count" integer DEFAULT 0,
	"is_homepage" boolean DEFAULT false,
	"requires_auth" boolean DEFAULT false,
	"allowed_roles" text[],
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"updated_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cms_templates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"template_type" text NOT NULL,
	"category" text,
	"thumbnail_url" text,
	"layout_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_system" boolean DEFAULT false,
	"is_published" boolean DEFAULT true,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"campaign_type" text NOT NULL,
	"goal_amount" numeric(10, 2),
	"current_amount" numeric(10, 2) DEFAULT '0',
	"currency" text DEFAULT 'CAD',
	"featured_image" text,
	"video_url" text,
	"start_date" date,
	"end_date" date,
	"status" text DEFAULT 'active' NOT NULL,
	"allow_recurring" boolean DEFAULT true,
	"suggested_amounts" integer[],
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"thank_you_message" text,
	"email_template_id" uuid,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"stripe_product_id" text,
	"stripe_price_ids" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donation_receipts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"donation_id" uuid NOT NULL,
	"receipt_number" text NOT NULL,
	"receipt_type" text NOT NULL,
	"amount" numeric(10, 2) NOT NULL,
	"issue_date" date NOT NULL,
	"pdf_url" text,
	"sent_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "donation_receipts_receipt_number_unique" UNIQUE("receipt_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "donations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"campaign_id" uuid,
	"donor_name" text,
	"donor_email" text,
	"donor_phone" text,
	"amount" numeric(10, 2) NOT NULL,
	"currency" text DEFAULT 'CAD',
	"is_recurring" boolean DEFAULT false,
	"recurring_interval" text,
	"is_anonymous" boolean DEFAULT false,
	"message" text,
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"stripe_payment_intent_id" text,
	"stripe_customer_id" text,
	"stripe_subscription_id" text,
	"payment_status" text DEFAULT 'pending' NOT NULL,
	"payment_method" text,
	"receipt_sent" boolean DEFAULT false,
	"receipt_url" text,
	"tax_receipt_number" text,
	"tax_receipt_issued_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_check_ins" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"registration_id" uuid NOT NULL,
	"check_in_method" text NOT NULL,
	"checked_in_by" text,
	"check_in_location" text,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "event_registrations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"event_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"member_number" text,
	"ticket_type" text,
	"ticket_price" numeric(10, 2),
	"number_of_guests" integer DEFAULT 0,
	"guest_names" text[],
	"custom_data" jsonb DEFAULT '{}'::jsonb,
	"registration_status" text DEFAULT 'confirmed' NOT NULL,
	"payment_status" text DEFAULT 'pending',
	"stripe_payment_intent_id" text,
	"payment_method" text,
	"confirmation_sent" boolean DEFAULT false,
	"reminder_sent" boolean DEFAULT false,
	"checked_in" boolean DEFAULT false,
	"checked_in_at" timestamp with time zone,
	"checked_in_by" text,
	"qr_code" text,
	"registration_source" text,
	"registered_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_applications" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"profile_id" text,
	"first_name" text NOT NULL,
	"last_name" text NOT NULL,
	"email" text NOT NULL,
	"phone" text,
	"resume_url" text,
	"cover_letter_url" text,
	"cover_letter_text" text,
	"linkedin_url" text,
	"portfolio_url" text,
	"years_experience" integer,
	"current_employer" text,
	"current_position" text,
	"availability_date" date,
	"salary_expectation" numeric(10, 2),
	"willing_to_relocate" boolean DEFAULT false,
	"is_union_member" boolean DEFAULT false,
	"union_local" text,
	"custom_responses" jsonb DEFAULT '{}'::jsonb,
	"application_status" text DEFAULT 'new' NOT NULL,
	"status_notes" text,
	"viewed_by" text,
	"viewed_at" timestamp with time zone,
	"interview_scheduled_for" timestamp with time zone,
	"rejection_reason" text,
	"source" text,
	"applied_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_postings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"employer_name" text NOT NULL,
	"employer_logo" text,
	"employer_website" text,
	"job_type" text NOT NULL,
	"category" text,
	"description" text NOT NULL,
	"responsibilities" text,
	"qualifications" text,
	"benefits" text,
	"salary_min" numeric(10, 2),
	"salary_max" numeric(10, 2),
	"salary_currency" text DEFAULT 'CAD',
	"salary_period" text,
	"salary_display" text,
	"location_type" text NOT NULL,
	"city" text,
	"province" text,
	"country" text DEFAULT 'Canada',
	"remote_allowed" boolean DEFAULT false,
	"experience_level" text,
	"education_required" text,
	"union_affiliation_required" boolean DEFAULT false,
	"union_name" text,
	"contact_name" text,
	"contact_email" text NOT NULL,
	"contact_phone" text,
	"application_method" text NOT NULL,
	"application_email" text,
	"application_url" text,
	"application_instructions" text,
	"requires_resume" boolean DEFAULT true,
	"requires_cover_letter" boolean DEFAULT false,
	"custom_questions" jsonb DEFAULT '[]'::jsonb,
	"status" text DEFAULT 'active' NOT NULL,
	"featured" boolean DEFAULT false,
	"views_count" integer DEFAULT 0,
	"applications_count" integer DEFAULT 0,
	"posted_date" date DEFAULT now() NOT NULL,
	"closing_date" date,
	"filled_date" date,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "job_saved" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"profile_id" text NOT NULL,
	"job_posting_id" uuid NOT NULL,
	"notes" text,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "page_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"page_id" uuid,
	"event_id" uuid,
	"job_id" uuid,
	"campaign_id" uuid,
	"metric_date" date DEFAULT now() NOT NULL,
	"page_views" integer DEFAULT 0,
	"unique_visitors" integer DEFAULT 0,
	"avg_time_on_page" integer DEFAULT 0,
	"bounce_rate" numeric(5, 2) DEFAULT '0',
	"traffic_sources" jsonb DEFAULT '{}'::jsonb,
	"device_breakdown" jsonb DEFAULT '{}'::jsonb,
	"conversion_count" integer DEFAULT 0,
	"created_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "public_events" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"title" text NOT NULL,
	"slug" text NOT NULL,
	"description" text,
	"event_type" text NOT NULL,
	"start_date" timestamp with time zone NOT NULL,
	"end_date" timestamp with time zone,
	"timezone" text DEFAULT 'America/Toronto',
	"location_type" text NOT NULL,
	"venue_name" text,
	"venue_address" text,
	"venue_city" text,
	"venue_state" text,
	"venue_postal_code" text,
	"venue_country" text DEFAULT 'Canada',
	"virtual_link" text,
	"virtual_platform" text,
	"featured_image" text,
	"capacity" integer,
	"registered_count" integer DEFAULT 0,
	"waitlist_enabled" boolean DEFAULT true,
	"registration_opens" timestamp with time zone,
	"registration_closes" timestamp with time zone,
	"registration_status" text DEFAULT 'open' NOT NULL,
	"is_free" boolean DEFAULT true,
	"ticket_price" numeric(10, 2),
	"member_price" numeric(10, 2),
	"currency" text DEFAULT 'CAD',
	"custom_fields" jsonb DEFAULT '[]'::jsonb,
	"confirmation_email_template" text,
	"reminder_email_template" text,
	"page_content" jsonb DEFAULT '[]'::jsonb,
	"seo_config" jsonb DEFAULT '{}'::jsonb,
	"tags" text[],
	"organizer_name" text,
	"organizer_email" text,
	"organizer_phone" text,
	"stripe_product_id" text,
	"stripe_price_id" text,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "website_settings" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"site_name" text NOT NULL,
	"site_tagline" text,
	"site_description" text,
	"logo_url" text,
	"favicon_url" text,
	"primary_color" text DEFAULT '#1E40AF',
	"secondary_color" text DEFAULT '#F59E0B',
	"font_family" text DEFAULT 'Inter',
	"footer_text" text,
	"footer_links" jsonb DEFAULT '[]'::jsonb,
	"social_links" jsonb DEFAULT '{}'::jsonb,
	"contact_email" text,
	"contact_phone" text,
	"contact_address" text,
	"google_analytics_id" text,
	"facebook_pixel_id" text,
	"custom_css" text,
	"custom_js" text,
	"maintenance_mode" boolean DEFAULT false,
	"maintenance_message" text,
	"created_at" timestamp with time zone DEFAULT now(),
	"updated_at" timestamp with time zone DEFAULT now(),
	CONSTRAINT "website_settings_organization_id_unique" UNIQUE("organization_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"bank_name" varchar(255) NOT NULL,
	"account_number" varchar(255) NOT NULL,
	"account_type" varchar(50) NOT NULL,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"current_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"available_balance" numeric(19, 4) DEFAULT '0' NOT NULL,
	"gl_account_id" uuid,
	"bank_feed_provider" varchar(50),
	"bank_feed_enabled" boolean DEFAULT false NOT NULL,
	"encrypted_bank_credentials" text,
	"last_sync_date" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_reconciliations" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"statement_date" timestamp with time zone NOT NULL,
	"statement_balance" numeric(19, 4) NOT NULL,
	"gl_balance" numeric(19, 4) NOT NULL,
	"difference" numeric(19, 4) NOT NULL,
	"status" varchar(50) DEFAULT 'in_progress' NOT NULL,
	"reconciled_by" varchar(255),
	"reconciled_at" timestamp with time zone,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bank_transactions" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"bank_account_id" uuid NOT NULL,
	"transaction_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"amount" numeric(19, 4) NOT NULL,
	"type" varchar(10) NOT NULL,
	"balance" numeric(19, 4),
	"reference" varchar(255),
	"payee" varchar(255),
	"category" varchar(255),
	"is_reconciled" boolean DEFAULT false NOT NULL,
	"reconciled_at" timestamp with time zone,
	"matched_transaction_id" uuid,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "currency_exchange_rates" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"target_currency" varchar(3) NOT NULL,
	"rate" numeric(19, 8) NOT NULL,
	"effective_date" timestamp with time zone NOT NULL,
	"source" varchar(100) NOT NULL,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_connectors" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" varchar(255) NOT NULL,
	"system_type" "erp_system" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"encrypted_credentials" text NOT NULL,
	"config" jsonb NOT NULL,
	"last_sync_at" timestamp with time zone,
	"last_error_at" timestamp with time zone,
	"last_error_message" text,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" varchar(255),
	"updated_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "erp_invoices" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"invoice_number" varchar(100) NOT NULL,
	"invoice_date" timestamp with time zone NOT NULL,
	"due_date" timestamp with time zone NOT NULL,
	"customer_id" varchar(255) NOT NULL,
	"customer_name" varchar(255) NOT NULL,
	"customer_email" varchar(255),
	"billing_address" jsonb,
	"shipping_address" jsonb,
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"subtotal" numeric(19, 4) NOT NULL,
	"tax_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"total_amount" numeric(19, 4) NOT NULL,
	"amount_paid" numeric(19, 4) DEFAULT '0' NOT NULL,
	"amount_due" numeric(19, 4) NOT NULL,
	"status" varchar(50) NOT NULL,
	"terms" text,
	"memo" text,
	"pdf_url" text,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "financial_audit_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"entity_id" uuid NOT NULL,
	"action" "audit_action" NOT NULL,
	"user_id" varchar(255) NOT NULL,
	"user_name" varchar(255) NOT NULL,
	"changes" jsonb,
	"metadata" jsonb,
	"ip_address" varchar(45),
	"user_agent" text,
	"timestamp" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entries" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid,
	"external_id" varchar(255),
	"entry_number" varchar(100) NOT NULL,
	"entry_date" timestamp with time zone NOT NULL,
	"posting_date" timestamp with time zone NOT NULL,
	"description" text NOT NULL,
	"reference" varchar(255),
	"currency" varchar(3) DEFAULT 'CAD' NOT NULL,
	"total_debit" numeric(19, 4) NOT NULL,
	"total_credit" numeric(19, 4) NOT NULL,
	"is_posted" boolean DEFAULT false NOT NULL,
	"is_reversed" boolean DEFAULT false NOT NULL,
	"reversal_entry_id" uuid,
	"created_by" varchar(255) NOT NULL,
	"approved_by" varchar(255),
	"approved_at" timestamp with time zone,
	"metadata" jsonb,
	"synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "journal_entry_lines" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"entry_id" uuid NOT NULL,
	"line_number" integer NOT NULL,
	"account_id" uuid NOT NULL,
	"debit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"credit_amount" numeric(19, 4) DEFAULT '0' NOT NULL,
	"description" text,
	"member_id" uuid,
	"bargaining_unit_id" uuid,
	"department_id" varchar(255),
	"location_id" varchar(255),
	"project_id" varchar(255),
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sync_jobs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"connector_id" uuid NOT NULL,
	"entity_type" varchar(100) NOT NULL,
	"direction" "sync_direction" NOT NULL,
	"status" "sync_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"completed_at" timestamp with time zone,
	"records_processed" integer DEFAULT 0 NOT NULL,
	"records_succeeded" integer DEFAULT 0 NOT NULL,
	"records_failed" integer DEFAULT 0 NOT NULL,
	"errors" jsonb,
	"metadata" jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_api_config" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"api_url" varchar(500) NOT NULL,
	"api_key_encrypted" varchar,
	"api_secret" varchar,
	"is_enabled" boolean DEFAULT true,
	"sync_frequency" varchar(50),
	"last_sync_at" timestamp,
	"next_sync_at" timestamp,
	"webhook_url_local" varchar(500),
	"webhook_secret_encrypted" varchar,
	"is_webhook_verified" boolean DEFAULT false,
	"sync_members_enabled" boolean DEFAULT true,
	"sync_remittances_enabled" boolean DEFAULT true,
	"sync_disputes_enabled" boolean DEFAULT false,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"configured_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_remittance_mapping" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"local_remittance_id" uuid,
	"external_remittance_id" varchar(100) NOT NULL,
	"local_data" jsonb,
	"external_data" jsonb,
	"reconciliation_status" varchar(50),
	"is_verified" boolean DEFAULT false,
	"verification_notes" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL,
	"verified_at" timestamp,
	"verified_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "clc_organization_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid,
	"affiliate_code" varchar(50) NOT NULL,
	"action" varchar(20) NOT NULL,
	"changes" text,
	"conflicts" json,
	"duration" integer NOT NULL,
	"error" text,
	"synced_at" timestamp with time zone DEFAULT now() NOT NULL,
	"synced_by" varchar(255)
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_accounts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"platform" "social_platform" NOT NULL,
	"platform_user_id" text NOT NULL,
	"username" text NOT NULL,
	"display_name" text NOT NULL,
	"profile_image_url" text,
	"access_token" text NOT NULL,
	"refresh_token" text,
	"token_expires_at" timestamp with time zone,
	"scopes" text[],
	"status" "social_account_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false,
	"is_verified" boolean DEFAULT false,
	"rate_limit_remaining" integer,
	"rate_limit_reset_at" timestamp with time zone,
	"follower_count" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"post_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"account_metadata" jsonb DEFAULT '{}'::jsonb,
	"connected_by" text,
	"connected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_synced_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_accounts_organization_id_platform_platform_user_id_unique" UNIQUE("organization_id","platform","platform_user_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_analytics" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"analytics_date" date NOT NULL,
	"follower_count" integer DEFAULT 0,
	"follower_change" integer DEFAULT 0,
	"following_count" integer DEFAULT 0,
	"posts_published" integer DEFAULT 0,
	"total_impressions" integer DEFAULT 0,
	"total_reach" integer DEFAULT 0,
	"total_likes" integer DEFAULT 0,
	"total_comments" integer DEFAULT 0,
	"total_shares" integer DEFAULT 0,
	"total_engagements" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"profile_visits" integer DEFAULT 0,
	"link_clicks" integer DEFAULT 0,
	"analytics_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_analytics_account_id_analytics_date_unique" UNIQUE("account_id","analytics_date")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_campaigns" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"name" text NOT NULL,
	"description" text,
	"campaign_code" text,
	"platforms" text[],
	"target_audience" text,
	"campaign_hashtags" text[],
	"status" "campaign_status" DEFAULT 'planning' NOT NULL,
	"start_date" date NOT NULL,
	"end_date" date,
	"goal_impressions" integer,
	"goal_engagement_rate" numeric(5, 2),
	"goal_conversions" integer,
	"campaign_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_engagement" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"post_id" uuid NOT NULL,
	"engagement_type" "engagement_type" NOT NULL,
	"platform_engagement_id" text,
	"platform_user_id" text,
	"username" text,
	"display_name" text,
	"profile_image_url" text,
	"content" text,
	"sentiment" text,
	"sentiment_score" numeric(5, 2),
	"engaged_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"engagement_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_feeds" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"platform_item_id" text NOT NULL,
	"item_type" text NOT NULL,
	"content" text,
	"media_urls" text[],
	"author_id" text,
	"author_name" text,
	"author_username" text,
	"author_image_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"published_at" timestamp with time zone NOT NULL,
	"fetched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"feed_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	CONSTRAINT "social_feeds_account_id_platform_item_id_unique" UNIQUE("account_id","platform_item_id")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "social_posts" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"account_id" uuid NOT NULL,
	"campaign_id" uuid,
	"post_type" "social_post_type" DEFAULT 'text' NOT NULL,
	"content" text NOT NULL,
	"media_urls" text[],
	"link_url" text,
	"link_preview_image" text,
	"hashtags" text[],
	"mentions" text[],
	"status" "social_post_status" DEFAULT 'draft' NOT NULL,
	"scheduled_for" timestamp with time zone,
	"published_at" timestamp with time zone,
	"platform_post_id" text,
	"platform_url" text,
	"likes_count" integer DEFAULT 0,
	"comments_count" integer DEFAULT 0,
	"shares_count" integer DEFAULT 0,
	"impressions_count" integer DEFAULT 0,
	"reach_count" integer DEFAULT 0,
	"engagement_rate" numeric(5, 2),
	"error_message" text,
	"retry_count" integer DEFAULT 0,
	"last_retry_at" timestamp with time zone,
	"post_metadata" jsonb DEFAULT '{}'::jsonb,
	"created_by" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "knowledge_base_articles" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"title" varchar(500) NOT NULL,
	"slug" varchar(500) NOT NULL,
	"summary" text,
	"content" text NOT NULL,
	"category" varchar(100) NOT NULL,
	"subcategory" varchar(100),
	"tags" jsonb DEFAULT '[]'::jsonb,
	"status" varchar(50) DEFAULT 'draft' NOT NULL,
	"visibility" varchar(50) DEFAULT 'public' NOT NULL,
	"view_count" integer DEFAULT 0,
	"helpful_count" integer DEFAULT 0,
	"not_helpful_count" integer DEFAULT 0,
	"meta_description" text,
	"meta_keywords" jsonb DEFAULT '[]'::jsonb,
	"version" integer DEFAULT 1,
	"published_at" timestamp with time zone,
	"last_reviewed_at" timestamp with time zone,
	"author_user_id" text,
	"author_name" varchar(255),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "knowledge_base_articles_slug_unique" UNIQUE("slug")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true,
	"is_default" boolean DEFAULT false,
	"priority" "ticket_priority",
	"category" "ticket_category",
	"organization_tier" varchar(50),
	"response_time_minutes" integer NOT NULL,
	"resolution_time_minutes" integer NOT NULL,
	"business_hours_only" boolean DEFAULT true,
	"timezone" varchar(100) DEFAULT 'UTC',
	"escalation_enabled" boolean DEFAULT false,
	"escalation_threshold_minutes" integer,
	"escalation_to_user_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "support_tickets" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_number" varchar(50) NOT NULL,
	"organization_id" uuid NOT NULL,
	"organization_name" varchar(255),
	"requestor_user_id" text,
	"requestor_email" varchar(255) NOT NULL,
	"requestor_name" varchar(255),
	"subject" varchar(500) NOT NULL,
	"description" text NOT NULL,
	"category" "ticket_category" NOT NULL,
	"priority" "ticket_priority" DEFAULT 'medium' NOT NULL,
	"status" "ticket_status" DEFAULT 'open' NOT NULL,
	"source" "ticket_source" NOT NULL,
	"assigned_to_user_id" text,
	"assigned_to_name" varchar(255),
	"assigned_at" timestamp with time zone,
	"sla_response_by" timestamp with time zone,
	"sla_resolve_by" timestamp with time zone,
	"first_response_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"response_sla_breach" boolean DEFAULT false,
	"resolution_sla_breach" boolean DEFAULT false,
	"response_time_minutes" integer,
	"resolution_time_minutes" integer,
	"tags" jsonb DEFAULT '[]'::jsonb,
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"satisfaction_rating" integer,
	"satisfaction_comment" text,
	"satisfaction_responded_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_by" text,
	"updated_by" text,
	CONSTRAINT "support_tickets_ticket_number_unique" UNIQUE("ticket_number")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_comments" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"is_internal" boolean DEFAULT false,
	"is_automated" boolean DEFAULT false,
	"author_user_id" text,
	"author_email" varchar(255),
	"author_name" varchar(255),
	"attachments" jsonb DEFAULT '[]'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ticket_history" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"ticket_id" uuid NOT NULL,
	"action" varchar(100) NOT NULL,
	"field" varchar(100),
	"old_value" text,
	"new_value" text,
	"changed_by_user_id" text,
	"changed_by_name" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_configs" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"type" "integration_type" NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"credentials" jsonb NOT NULL,
	"settings" jsonb,
	"webhook_url" text,
	"enabled" boolean DEFAULT true,
	"last_sync_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_log" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"status" "sync_status" NOT NULL,
	"records_processed" integer DEFAULT 0,
	"records_created" integer DEFAULT 0,
	"records_updated" integer DEFAULT 0,
	"records_failed" integer DEFAULT 0,
	"cursor" text,
	"error" text,
	"started_at" timestamp DEFAULT now(),
	"completed_at" timestamp
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "integration_sync_schedules" (
	"id" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"sync_type" "sync_type" NOT NULL,
	"entities" text[],
	"schedule" text NOT NULL,
	"enabled" boolean DEFAULT true,
	"last_run_at" timestamp,
	"next_run_at" timestamp,
	"created_at" timestamp DEFAULT now(),
	"updated_at" timestamp DEFAULT now()
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" uuid NOT NULL,
	"provider" "integration_provider" NOT NULL,
	"event_type" text NOT NULL,
	"payload" jsonb NOT NULL,
	"signature" text,
	"verified" boolean DEFAULT false,
	"status" "webhook_status" DEFAULT 'received' NOT NULL,
	"error" text,
	"received_at" timestamp DEFAULT now(),
	"processed_at" timestamp
);
--> statement-breakpoint
-- ALTER TABLE "user_management"."tenant_users" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."database_pools" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_configurations" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenant_usage" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "tenant_management"."tenants" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_analytics" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "communication_preferences" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- ALTER TABLE "user_engagement_scores" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
-- DROP TABLE "user_management"."tenant_users" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."database_pools" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_configurations" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenant_usage" CASCADE;--> statement-breakpoint
-- DROP TABLE "tenant_management"."tenants" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_analytics" CASCADE;--> statement-breakpoint
-- DROP TABLE "communication_preferences" CASCADE;--> statement-breakpoint
-- DROP TABLE "user_engagement_scores" CASCADE;--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP CONSTRAINT "collective_agreements_cba_number_unique";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP CONSTRAINT "wallet_balance_non_negative";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP CONSTRAINT "clc_sync_log_organization_id_fkey";
--> statement-breakpoint
ALTER TABLE "poll_votes" DROP CONSTRAINT "poll_votes_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "polls" DROP CONSTRAINT "polls_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_answers" DROP CONSTRAINT "survey_answers_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_questions" DROP CONSTRAINT "survey_questions_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "survey_responses" DROP CONSTRAINT "survey_responses_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "surveys" DROP CONSTRAINT "surveys_tenant_id_tenants_tenant_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_claim_id_claims_claim_id_fk";
--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP CONSTRAINT "grievance_deadlines_stage_id_grievance_stages_id_fk";
--> statement-breakpoint
ALTER TABLE "automation_rules" DROP CONSTRAINT "automation_rules_org_id_organizations_id_fk";
--> statement-breakpoint
ALTER TABLE "automation_rules" DROP CONSTRAINT "automation_rules_award_type_id_recognition_award_types_id_fk";
--> statement-breakpoint
$;
--> statement-breakpoint
ALTER TABLE "deadline_alerts" ALTER COLUMN "alert_severity" SET DATA TYPE text;--> statement-breakpoint
ALTER TABLE "alert_rules" ALTER COLUMN "severity" SET DATA TYPE text;--> statement-breakpoint
ALTER TABLE "alert_rules" ALTER COLUMN "severity" SET DEFAULT 'medium'::text;--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_severity" CASCADE;--> statement-breakpoint
DROP TYPE IF EXISTS "public"."alert_severity" CASCADE;--> statement-breakpoint
CREATE TYPE "public"."alert_severity" AS ENUM('critical', 'high', 'medium', 'low', 'info');--> statement-breakpoint
ALTER TABLE "deadline_alerts" ALTER COLUMN "alert_severity" SET DATA TYPE "public"."alert_severity" USING "alert_severity"::"public"."alert_severity";--> statement-breakpoint
ALTER TABLE "alert_rules" ALTER COLUMN "severity" SET DEFAULT 'medium'::"public"."alert_severity";--> statement-breakpoint
ALTER TABLE "alert_rules" ALTER COLUMN "severity" SET DATA TYPE "public"."alert_severity" USING "severity"::"public"."alert_severity";--> statement-breakpoint
DROP INDEX "cba_organization_idx";--> statement-breakpoint
DROP INDEX "cba_jurisdiction_idx";--> statement-breakpoint
DROP INDEX "cba_employer_idx";--> statement-breakpoint
DROP INDEX "cba_union_idx";--> statement-breakpoint
DROP INDEX "cba_expiry_idx";--> statement-breakpoint
DROP INDEX "cba_status_idx";--> statement-breakpoint
DROP INDEX "cba_effective_date_idx";--> statement-breakpoint
DROP INDEX "cba_sector_idx";--> statement-breakpoint
DROP INDEX "idx_sync_log_org";--> statement-breakpoint
DROP INDEX "idx_sync_log_affiliate";--> statement-breakpoint
DROP INDEX "idx_sync_log_synced_at";--> statement-breakpoint
DROP INDEX "idx_webhook_log_received_at";--> statement-breakpoint
DROP INDEX "idx_poll_votes_tenant";--> statement-breakpoint
DROP INDEX "idx_polls_tenant";--> statement-breakpoint
DROP INDEX "idx_survey_answers_tenant";--> statement-breakpoint
DROP INDEX "idx_survey_questions_tenant";--> statement-breakpoint
DROP INDEX "idx_survey_responses_tenant";--> statement-breakpoint
DROP INDEX "idx_surveys_tenant";--> statement-breakpoint
DROP INDEX "idx_grievance_deadlines_organization";--> statement-breakpoint
DROP INDEX "idx_grievance_deadlines_claim";--> statement-breakpoint
DROP INDEX "idx_grievance_deadlines_stage";--> statement-breakpoint
DROP INDEX "idx_grievance_deadlines_date";--> statement-breakpoint
DROP INDEX "idx_grievance_deadlines_type";--> statement-breakpoint
DROP INDEX "automation_rules_org_idx";--> statement-breakpoint
DROP INDEX "automation_rules_trigger_idx";--> statement-breakpoint
DROP INDEX "automation_rules_active_idx";--> statement-breakpoint
DROP INDEX "automation_rules_award_type_idx";--> statement-breakpoint
DROP INDEX "reward_wallet_ledger_org_user_idx";--> statement-breakpoint
DROP INDEX "reward_wallet_ledger_user_created_idx";--> statement-breakpoint
DROP INDEX "cookie_consents_tenant_id_idx";--> statement-breakpoint
DROP INDEX "anonymization_log_tenant_id_idx";--> statement-breakpoint
DROP INDEX "data_processing_tenant_id_idx";--> statement-breakpoint
DROP INDEX "retention_policies_tenant_id_idx";--> statement-breakpoint
DROP INDEX "gdpr_requests_tenant_id_idx";--> statement-breakpoint
DROP INDEX "user_consents_tenant_id_idx";--> statement-breakpoint
DROP INDEX "signature_documents_tenant_id_idx";--> statement-breakpoint
DROP INDEX "signature_templates_tenant_id_idx";--> statement-breakpoint
DROP INDEX "chat_sessions_tenant_id_idx";--> statement-breakpoint
DROP INDEX "chatbot_analytics_tenant_id_idx";--> statement-breakpoint
DROP INDEX "chatbot_suggestions_tenant_id_idx";--> statement-breakpoint
DROP INDEX "knowledge_base_tenant_id_idx";--> statement-breakpoint
DROP INDEX "accessibility_audits_tenant_id_idx";--> statement-breakpoint
DROP INDEX "accessibility_issues_tenant_id_idx";--> statement-breakpoint
DROP INDEX "accessibility_test_suites_tenant_id_idx";--> statement-breakpoint
DROP INDEX "accessibility_user_testing_tenant_id_idx";--> statement-breakpoint
DROP INDEX "international_addresses_tenant_id_idx";--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "jurisdiction" SET DATA TYPE varchar(100);--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "jurisdiction" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "employer_name" SET DATA TYPE varchar(200);--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "employer_name" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "effective_date" SET DATA TYPE date;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "effective_date" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "expiry_date" SET DATA TYPE date;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "expiry_date" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "status" SET DATA TYPE varchar(50);--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "status" SET DEFAULT 'active';--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "created_at" SET DATA TYPE timestamp;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "created_at" SET DEFAULT now();--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "updated_at" SET DATA TYPE timestamp;--> statement-breakpoint
ALTER TABLE "collective_agreements" ALTER COLUMN "updated_at" SET DEFAULT now();--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ALTER COLUMN "type" SET DATA TYPE varchar(50);--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ALTER COLUMN "affiliate_code" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ALTER COLUMN "payload" SET DATA TYPE json;--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ALTER COLUMN "payload" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ALTER COLUMN "received_at" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "newsletter_list_subscribers" ALTER COLUMN "profile_id" SET DATA TYPE text;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ALTER COLUMN "due_date" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ALTER COLUMN "description" SET DATA TYPE varchar(500);--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ALTER COLUMN "status" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ALTER COLUMN "reminder_days" DROP DEFAULT;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ALTER COLUMN "created_at" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ALTER COLUMN "updated_at" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "automation_rules" ALTER COLUMN "created_at" SET DATA TYPE timestamp with time zone;--> statement-breakpoint
ALTER TABLE "automation_rules" ALTER COLUMN "created_at" SET DEFAULT now();--> statement-breakpoint
ALTER TABLE "automation_rules" ALTER COLUMN "updated_at" SET DATA TYPE timestamp with time zone;--> statement-breakpoint
ALTER TABLE "automation_rules" ALTER COLUMN "updated_at" SET DEFAULT now();--> statement-breakpoint
ALTER TABLE "votes" ADD COLUMN "signature" text;--> statement-breakpoint
ALTER TABLE "votes" ADD COLUMN "receipt_id" varchar(255);--> statement-breakpoint
ALTER TABLE "votes" ADD COLUMN "verification_code" varchar(100);--> statement-breakpoint
ALTER TABLE "votes" ADD COLUMN "audit_hash" varchar(255);--> statement-breakpoint
-- ALTER TABLE "audit_security"."audit_logs" ADD COLUMN "archived" boolean DEFAULT false NOT NULL;--> statement-breakpoint
-- ALTER TABLE "audit_security"."audit_logs" ADD COLUMN "archived_at" timestamp with time zone;--> statement-breakpoint
-- ALTER TABLE "audit_security"."audit_logs" ADD COLUMN "archived_path" text;--> statement-breakpoint
ALTER TABLE "in_app_notifications" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "notification_bounces" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "notification_delivery_log" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "notification_history" ADD COLUMN "organization_id" uuid;--> statement-breakpoint
ALTER TABLE "notification_queue" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "notification_templates" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "notifications" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "user_notification_preferences" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "calendar_events" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "calendar_sharing" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "calendars" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "event_attendees" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "event_reminders" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "external_calendar_connections" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "meeting_rooms" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "room_bookings" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "deadline_alerts" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "deadline_extensions" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "deadline_rules" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "claim_deadlines" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "holidays" ADD COLUMN "organization_id" uuid;--> statement-breakpoint
ALTER TABLE "report_executions" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "report_shares" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "report_templates" ADD COLUMN "organization_id" uuid;--> statement-breakpoint
ALTER TABLE "reports" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "scheduled_reports" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "organizations" ADD COLUMN "description" text;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "sync_type" varchar(50) NOT NULL;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "sync_id" varchar(100) NOT NULL;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "started_at" timestamp with time zone DEFAULT now() NOT NULL;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "completed_at" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "status" varchar(20) DEFAULT 'running' NOT NULL;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "records_processed" integer DEFAULT 0;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "records_inserted" integer DEFAULT 0;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "records_updated" integer DEFAULT 0;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "records_failed" integer DEFAULT 0;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "access_token_used" varchar(50);--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "token_refreshed" boolean DEFAULT false;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "error_message" text;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "error_details" text;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "parameters" text;--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD COLUMN "initiated_by" varchar(100);--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ADD COLUMN "processing_duration" integer;--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ADD COLUMN "processed_at" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "poll_votes" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "polls" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "survey_answers" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "survey_questions" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "survey_responses" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "surveys" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ADD COLUMN "grievance_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ADD COLUMN "extension_granted" boolean DEFAULT false;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ADD COLUMN "new_deadline" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ADD COLUMN "reminders_sent" jsonb;--> statement-breakpoint
ALTER TABLE "document_folders" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "documents" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "status" varchar(20) DEFAULT 'draft' NOT NULL;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "priority" integer DEFAULT 100;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "target_entity" varchar(50) NOT NULL;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "target_filter" jsonb;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "trigger_config" jsonb;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "actions" jsonb;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "max_executions" integer;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "executions_count" integer DEFAULT 0;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "last_executed_at" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "active_from" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "active_until" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "timezone" varchar(50) DEFAULT 'UTC';--> statement-breakpoint
ALTER TABLE "automation_rules" ADD COLUMN "organization_id" varchar(255);--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "transaction_type" varchar(50) NOT NULL;--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "points_change" integer NOT NULL;--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "award_id" uuid;--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "reference_type" varchar(50);--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "reference_id" varchar(255);--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "expires_at" timestamp with time zone;--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" ADD COLUMN "description" text;--> statement-breakpoint
ALTER TABLE "feature_flags" ADD COLUMN "allowed_organizations" json;--> statement-breakpoint
ALTER TABLE "cookie_consents" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "data_anonymization_log" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "data_processing_records" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "data_retention_policies" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "gdpr_data_requests" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "user_consents" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "signature_documents" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "signature_templates" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "chat_sessions" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "chatbot_analytics" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "chatbot_suggestions" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "knowledge_base" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "knowledge_base" ADD COLUMN "allowed_organizations" jsonb;--> statement-breakpoint
ALTER TABLE "accessibility_audits" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "accessibility_issues" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "accessibility_test_suites" ADD COLUMN "organization_id" uuid;--> statement-breakpoint
ALTER TABLE "accessibility_user_testing" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
ALTER TABLE "international_addresses" ADD COLUMN "organization_id" uuid NOT NULL;--> statement-breakpoint
-- ALTER TABLE "user_management"."organization_users" ADD CONSTRAINT "organization_users_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
-- ALTER TABLE "user_management"."organization_users" ADD CONSTRAINT "organization_users_invited_by_users_user_id_fk" FOREIGN KEY ("invited_by") REFERENCES "user_management"."users"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "grievance_approvals" ADD CONSTRAINT "grievance_approvals_transition_id_grievance_transitions_id_fk" FOREIGN KEY ("transition_id") REFERENCES "public"."grievance_transitions"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bargaining_proposals" ADD CONSTRAINT "bargaining_proposals_negotiation_id_negotiations_id_fk" FOREIGN KEY ("negotiation_id") REFERENCES "public"."negotiations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bargaining_proposals" ADD CONSTRAINT "bargaining_proposals_parent_proposal_id_bargaining_proposals_id_fk" FOREIGN KEY ("parent_proposal_id") REFERENCES "public"."bargaining_proposals"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bargaining_proposals" ADD CONSTRAINT "bargaining_proposals_superseded_by_id_bargaining_proposals_id_fk" FOREIGN KEY ("superseded_by_id") REFERENCES "public"."bargaining_proposals"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bargaining_team_members" ADD CONSTRAINT "bargaining_team_members_negotiation_id_negotiations_id_fk" FOREIGN KEY ("negotiation_id") REFERENCES "public"."negotiations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "negotiation_sessions" ADD CONSTRAINT "negotiation_sessions_negotiation_id_negotiations_id_fk" FOREIGN KEY ("negotiation_id") REFERENCES "public"."negotiations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "negotiations" ADD CONSTRAINT "negotiations_expiring_cba_id_collective_agreements_id_fk" FOREIGN KEY ("expiring_cba_id") REFERENCES "public"."collective_agreements"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "negotiations" ADD CONSTRAINT "negotiations_resulting_cba_id_collective_agreements_id_fk" FOREIGN KEY ("resulting_cba_id") REFERENCES "public"."collective_agreements"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "tentative_agreements" ADD CONSTRAINT "tentative_agreements_negotiation_id_negotiations_id_fk" FOREIGN KEY ("negotiation_id") REFERENCES "public"."negotiations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_reconciliation" ADD CONSTRAINT "bank_reconciliation_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payment_cycles" ADD CONSTRAINT "payment_cycles_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_payment_id_payments_id_fk" FOREIGN KEY ("payment_id") REFERENCES "public"."payments"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_member_id_profiles_user_id_fk" FOREIGN KEY ("member_id") REFERENCES "public"."profiles"("user_id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payments" ADD CONSTRAINT "payments_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payments" ADD CONSTRAINT "payments_member_id_profiles_user_id_fk" FOREIGN KEY ("member_id") REFERENCES "public"."profiles"("user_id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "payments" ADD CONSTRAINT "payments_payment_cycle_id_payment_cycles_id_fk" FOREIGN KEY ("payment_cycle_id") REFERENCES "public"."payment_cycles"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "stripe_webhook_events" ADD CONSTRAINT "stripe_webhook_events_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "chart_of_accounts" ADD CONSTRAINT "chart_of_accounts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "chart_of_accounts" ADD CONSTRAINT "chart_of_accounts_parent_account_id_chart_of_accounts_id_fk" FOREIGN KEY ("parent_account_id") REFERENCES "public"."chart_of_accounts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cost_centers" ADD CONSTRAINT "cost_centers_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cost_centers" ADD CONSTRAINT "cost_centers_parent_cost_center_id_cost_centers_id_fk" FOREIGN KEY ("parent_cost_center_id") REFERENCES "public"."cost_centers"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_account_mappings" ADD CONSTRAINT "gl_account_mappings_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_account_mappings" ADD CONSTRAINT "gl_account_mappings_chart_of_accounts_id_chart_of_accounts_id_fk" FOREIGN KEY ("chart_of_accounts_id") REFERENCES "public"."chart_of_accounts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_transaction_log" ADD CONSTRAINT "gl_transaction_log_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_transaction_log" ADD CONSTRAINT "gl_transaction_log_chart_of_accounts_id_chart_of_accounts_id_fk" FOREIGN KEY ("chart_of_accounts_id") REFERENCES "public"."chart_of_accounts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_transaction_log" ADD CONSTRAINT "gl_transaction_log_cost_center_id_cost_centers_id_fk" FOREIGN KEY ("cost_center_id") REFERENCES "public"."cost_centers"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_trial_balance" ADD CONSTRAINT "gl_trial_balance_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gl_trial_balance" ADD CONSTRAINT "gl_trial_balance_chart_of_accounts_id_chart_of_accounts_id_fk" FOREIGN KEY ("chart_of_accounts_id") REFERENCES "public"."chart_of_accounts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_audit_log" ADD CONSTRAINT "signature_audit_log_workflow_id_signature_workflows_id_fk" FOREIGN KEY ("workflow_id") REFERENCES "public"."signature_workflows"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_audit_log" ADD CONSTRAINT "signature_audit_log_signer_id_signers_id_fk" FOREIGN KEY ("signer_id") REFERENCES "public"."signers"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_verification" ADD CONSTRAINT "signature_verification_workflow_id_signature_workflows_id_fk" FOREIGN KEY ("workflow_id") REFERENCES "public"."signature_workflows"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_verification" ADD CONSTRAINT "signature_verification_signer_id_signers_id_fk" FOREIGN KEY ("signer_id") REFERENCES "public"."signers"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_workflows" ADD CONSTRAINT "signature_workflows_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_workflows" ADD CONSTRAINT "signature_workflows_document_id_documents_id_fk" FOREIGN KEY ("document_id") REFERENCES "public"."documents"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signers" ADD CONSTRAINT "signers_workflow_id_signature_workflows_id_fk" FOREIGN KEY ("workflow_id") REFERENCES "public"."signature_workflows"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signers" ADD CONSTRAINT "signers_member_id_profiles_user_id_fk" FOREIGN KEY ("member_id") REFERENCES "public"."profiles"("user_id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "congress_memberships" ADD CONSTRAINT "congress_memberships_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "congress_memberships" ADD CONSTRAINT "congress_memberships_congress_id_organizations_id_fk" FOREIGN KEY ("congress_id") REFERENCES "public"."organizations"("id") ON DELETE restrict ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_departments" ADD CONSTRAINT "external_departments_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_employees" ADD CONSTRAINT "external_employees_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_positions" ADD CONSTRAINT "external_positions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_accounts" ADD CONSTRAINT "external_accounts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_customers" ADD CONSTRAINT "external_customers_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_invoices" ADD CONSTRAINT "external_invoices_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_payments" ADD CONSTRAINT "external_payments_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_benefit_coverage" ADD CONSTRAINT "external_benefit_coverage_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_benefit_dependents" ADD CONSTRAINT "external_benefit_dependents_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_benefit_enrollments" ADD CONSTRAINT "external_benefit_enrollments_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_benefit_plans" ADD CONSTRAINT "external_benefit_plans_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_benefit_utilization" ADD CONSTRAINT "external_benefit_utilization_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_insurance_beneficiaries" ADD CONSTRAINT "external_insurance_beneficiaries_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_insurance_claims" ADD CONSTRAINT "external_insurance_claims_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_insurance_policies" ADD CONSTRAINT "external_insurance_policies_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_communication_channels" ADD CONSTRAINT "external_communication_channels_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_communication_files" ADD CONSTRAINT "external_communication_files_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_communication_files" ADD CONSTRAINT "external_communication_files_channel_id_external_communication_channels_id_fk" FOREIGN KEY ("channel_id") REFERENCES "public"."external_communication_channels"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_communication_messages" ADD CONSTRAINT "external_communication_messages_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_communication_messages" ADD CONSTRAINT "external_communication_messages_channel_id_external_communication_channels_id_fk" FOREIGN KEY ("channel_id") REFERENCES "public"."external_communication_channels"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_communication_users" ADD CONSTRAINT "external_communication_users_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_lms_completions" ADD CONSTRAINT "external_lms_completions_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_lms_courses" ADD CONSTRAINT "external_lms_courses_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_lms_enrollments" ADD CONSTRAINT "external_lms_enrollments_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_lms_learners" ADD CONSTRAINT "external_lms_learners_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_lms_progress" ADD CONSTRAINT "external_lms_progress_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_document_files" ADD CONSTRAINT "external_document_files_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_document_files" ADD CONSTRAINT "external_document_files_library_id_external_document_libraries_id_fk" FOREIGN KEY ("library_id") REFERENCES "public"."external_document_libraries"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_document_libraries" ADD CONSTRAINT "external_document_libraries_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_document_permissions" ADD CONSTRAINT "external_document_permissions_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_document_permissions" ADD CONSTRAINT "external_document_permissions_file_id_external_document_files_id_fk" FOREIGN KEY ("file_id") REFERENCES "public"."external_document_files"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_document_sites" ADD CONSTRAINT "external_document_sites_org_id_organizations_id_fk" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "model_metadata" ADD CONSTRAINT "model_metadata_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "analytics_scheduled_reports" ADD CONSTRAINT "analytics_scheduled_reports_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "benchmark_data" ADD CONSTRAINT "benchmark_data_benchmark_category_id_benchmark_categories_id_fk" FOREIGN KEY ("benchmark_category_id") REFERENCES "public"."benchmark_categories"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organization_benchmark_snapshots" ADD CONSTRAINT "organization_benchmark_snapshots_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organization_benchmark_snapshots" ADD CONSTRAINT "organization_benchmark_snapshots_benchmark_category_id_benchmark_categories_id_fk" FOREIGN KEY ("benchmark_category_id") REFERENCES "public"."benchmark_categories"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "report_delivery_history" ADD CONSTRAINT "report_delivery_history_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "report_delivery_history" ADD CONSTRAINT "report_delivery_history_scheduled_report_id_analytics_scheduled_reports_id_fk" FOREIGN KEY ("scheduled_report_id") REFERENCES "public"."analytics_scheduled_reports"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_actions" ADD CONSTRAINT "alert_actions_alert_rule_id_alert_rules_id_fk" FOREIGN KEY ("alert_rule_id") REFERENCES "public"."alert_rules"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_conditions" ADD CONSTRAINT "alert_conditions_alert_rule_id_alert_rules_id_fk" FOREIGN KEY ("alert_rule_id") REFERENCES "public"."alert_rules"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_escalations" ADD CONSTRAINT "alert_escalations_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_escalations" ADD CONSTRAINT "alert_escalations_alert_rule_id_alert_rules_id_fk" FOREIGN KEY ("alert_rule_id") REFERENCES "public"."alert_rules"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_escalations" ADD CONSTRAINT "alert_escalations_resolved_by_profiles_user_id_fk" FOREIGN KEY ("resolved_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_executions" ADD CONSTRAINT "alert_executions_alert_rule_id_alert_rules_id_fk" FOREIGN KEY ("alert_rule_id") REFERENCES "public"."alert_rules"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_recipients" ADD CONSTRAINT "alert_recipients_alert_rule_id_alert_rules_id_fk" FOREIGN KEY ("alert_rule_id") REFERENCES "public"."alert_rules"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_rules" ADD CONSTRAINT "alert_rules_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "alert_rules" ADD CONSTRAINT "alert_rules_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "workflow_definitions" ADD CONSTRAINT "workflow_definitions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "workflow_definitions" ADD CONSTRAINT "workflow_definitions_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "workflow_executions" ADD CONSTRAINT "workflow_executions_workflow_definition_id_workflow_definitions_id_fk" FOREIGN KEY ("workflow_definition_id") REFERENCES "public"."workflow_definitions"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "workflow_executions" ADD CONSTRAINT "workflow_executions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "card_signing_events" ADD CONSTRAINT "card_signing_events_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "card_signing_events" ADD CONSTRAINT "card_signing_events_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "card_signing_events" ADD CONSTRAINT "card_signing_events_contact_id_organizing_contacts_id_fk" FOREIGN KEY ("contact_id") REFERENCES "public"."organizing_contacts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "card_signing_events" ADD CONSTRAINT "card_signing_events_witnessed_by_profiles_user_id_fk" FOREIGN KEY ("witnessed_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "card_signing_events" ADD CONSTRAINT "card_signing_events_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "employer_responses" ADD CONSTRAINT "employer_responses_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "employer_responses" ADD CONSTRAINT "employer_responses_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "employer_responses" ADD CONSTRAINT "employer_responses_affected_contact_id_organizing_contacts_id_fk" FOREIGN KEY ("affected_contact_id") REFERENCES "public"."organizing_contacts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "employer_responses" ADD CONSTRAINT "employer_responses_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "employer_responses" ADD CONSTRAINT "employer_responses_updated_by_profiles_user_id_fk" FOREIGN KEY ("updated_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "field_organizer_activities" ADD CONSTRAINT "field_organizer_activities_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "field_organizer_activities" ADD CONSTRAINT "field_organizer_activities_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "field_organizer_activities" ADD CONSTRAINT "field_organizer_activities_organizer_id_profiles_user_id_fk" FOREIGN KEY ("organizer_id") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "field_organizer_activities" ADD CONSTRAINT "field_organizer_activities_contact_id_organizing_contacts_id_fk" FOREIGN KEY ("contact_id") REFERENCES "public"."organizing_contacts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "field_organizer_activities" ADD CONSTRAINT "field_organizer_activities_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "nlrb_clrb_filings" ADD CONSTRAINT "nlrb_clrb_filings_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "nlrb_clrb_filings" ADD CONSTRAINT "nlrb_clrb_filings_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "nlrb_clrb_filings" ADD CONSTRAINT "nlrb_clrb_filings_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "nlrb_clrb_filings" ADD CONSTRAINT "nlrb_clrb_filings_updated_by_profiles_user_id_fk" FOREIGN KEY ("updated_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaign_milestones" ADD CONSTRAINT "organizing_campaign_milestones_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaign_milestones" ADD CONSTRAINT "organizing_campaign_milestones_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaign_milestones" ADD CONSTRAINT "organizing_campaign_milestones_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaigns" ADD CONSTRAINT "organizing_campaigns_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaigns" ADD CONSTRAINT "organizing_campaigns_lead_organizer_id_profiles_user_id_fk" FOREIGN KEY ("lead_organizer_id") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaigns" ADD CONSTRAINT "organizing_campaigns_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_campaigns" ADD CONSTRAINT "organizing_campaigns_updated_by_profiles_user_id_fk" FOREIGN KEY ("updated_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_contacts" ADD CONSTRAINT "organizing_contacts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_contacts" ADD CONSTRAINT "organizing_contacts_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_contacts" ADD CONSTRAINT "organizing_contacts_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "organizing_contacts" ADD CONSTRAINT "organizing_contacts_updated_by_profiles_user_id_fk" FOREIGN KEY ("updated_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "union_representation_votes" ADD CONSTRAINT "union_representation_votes_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "union_representation_votes" ADD CONSTRAINT "union_representation_votes_campaign_id_organizing_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."organizing_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "union_representation_votes" ADD CONSTRAINT "union_representation_votes_filing_id_nlrb_clrb_filings_id_fk" FOREIGN KEY ("filing_id") REFERENCES "public"."nlrb_clrb_filings"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "union_representation_votes" ADD CONSTRAINT "union_representation_votes_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_blocks" ADD CONSTRAINT "cms_blocks_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_blocks" ADD CONSTRAINT "cms_blocks_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_media_library" ADD CONSTRAINT "cms_media_library_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_media_library" ADD CONSTRAINT "cms_media_library_uploaded_by_profiles_user_id_fk" FOREIGN KEY ("uploaded_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_navigation_menus" ADD CONSTRAINT "cms_navigation_menus_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_pages" ADD CONSTRAINT "cms_pages_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_pages" ADD CONSTRAINT "cms_pages_template_id_cms_templates_id_fk" FOREIGN KEY ("template_id") REFERENCES "public"."cms_templates"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_pages" ADD CONSTRAINT "cms_pages_parent_page_id_cms_pages_id_fk" FOREIGN KEY ("parent_page_id") REFERENCES "public"."cms_pages"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_pages" ADD CONSTRAINT "cms_pages_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_pages" ADD CONSTRAINT "cms_pages_updated_by_profiles_user_id_fk" FOREIGN KEY ("updated_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_templates" ADD CONSTRAINT "cms_templates_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cms_templates" ADD CONSTRAINT "cms_templates_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "donation_campaigns" ADD CONSTRAINT "donation_campaigns_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "donation_campaigns" ADD CONSTRAINT "donation_campaigns_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "donation_receipts" ADD CONSTRAINT "donation_receipts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "donation_receipts" ADD CONSTRAINT "donation_receipts_donation_id_donations_id_fk" FOREIGN KEY ("donation_id") REFERENCES "public"."donations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "donations" ADD CONSTRAINT "donations_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "donations" ADD CONSTRAINT "donations_campaign_id_donation_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."donation_campaigns"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_check_ins" ADD CONSTRAINT "event_check_ins_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_check_ins" ADD CONSTRAINT "event_check_ins_event_id_public_events_id_fk" FOREIGN KEY ("event_id") REFERENCES "public"."public_events"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_check_ins" ADD CONSTRAINT "event_check_ins_registration_id_event_registrations_id_fk" FOREIGN KEY ("registration_id") REFERENCES "public"."event_registrations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_check_ins" ADD CONSTRAINT "event_check_ins_checked_in_by_profiles_user_id_fk" FOREIGN KEY ("checked_in_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_registrations" ADD CONSTRAINT "event_registrations_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_registrations" ADD CONSTRAINT "event_registrations_event_id_public_events_id_fk" FOREIGN KEY ("event_id") REFERENCES "public"."public_events"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_registrations" ADD CONSTRAINT "event_registrations_profile_id_profiles_user_id_fk" FOREIGN KEY ("profile_id") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_registrations" ADD CONSTRAINT "event_registrations_checked_in_by_profiles_user_id_fk" FOREIGN KEY ("checked_in_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_applications" ADD CONSTRAINT "job_applications_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_applications" ADD CONSTRAINT "job_applications_job_posting_id_job_postings_id_fk" FOREIGN KEY ("job_posting_id") REFERENCES "public"."job_postings"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_applications" ADD CONSTRAINT "job_applications_profile_id_profiles_user_id_fk" FOREIGN KEY ("profile_id") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_applications" ADD CONSTRAINT "job_applications_viewed_by_profiles_user_id_fk" FOREIGN KEY ("viewed_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_postings" ADD CONSTRAINT "job_postings_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_postings" ADD CONSTRAINT "job_postings_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_saved" ADD CONSTRAINT "job_saved_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_saved" ADD CONSTRAINT "job_saved_profile_id_profiles_user_id_fk" FOREIGN KEY ("profile_id") REFERENCES "public"."profiles"("user_id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "job_saved" ADD CONSTRAINT "job_saved_job_posting_id_job_postings_id_fk" FOREIGN KEY ("job_posting_id") REFERENCES "public"."job_postings"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "page_analytics" ADD CONSTRAINT "page_analytics_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "page_analytics" ADD CONSTRAINT "page_analytics_page_id_cms_pages_id_fk" FOREIGN KEY ("page_id") REFERENCES "public"."cms_pages"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "page_analytics" ADD CONSTRAINT "page_analytics_event_id_public_events_id_fk" FOREIGN KEY ("event_id") REFERENCES "public"."public_events"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "page_analytics" ADD CONSTRAINT "page_analytics_job_id_job_postings_id_fk" FOREIGN KEY ("job_id") REFERENCES "public"."job_postings"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "page_analytics" ADD CONSTRAINT "page_analytics_campaign_id_donation_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."donation_campaigns"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "public_events" ADD CONSTRAINT "public_events_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "public_events" ADD CONSTRAINT "public_events_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "website_settings" ADD CONSTRAINT "website_settings_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_accounts" ADD CONSTRAINT "bank_accounts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_accounts" ADD CONSTRAINT "bank_accounts_connector_id_erp_connectors_id_fk" FOREIGN KEY ("connector_id") REFERENCES "public"."erp_connectors"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_accounts" ADD CONSTRAINT "bank_accounts_gl_account_id_chart_of_accounts_id_fk" FOREIGN KEY ("gl_account_id") REFERENCES "public"."chart_of_accounts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_reconciliations" ADD CONSTRAINT "bank_reconciliations_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_reconciliations" ADD CONSTRAINT "bank_reconciliations_bank_account_id_bank_accounts_id_fk" FOREIGN KEY ("bank_account_id") REFERENCES "public"."bank_accounts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "bank_transactions" ADD CONSTRAINT "bank_transactions_bank_account_id_bank_accounts_id_fk" FOREIGN KEY ("bank_account_id") REFERENCES "public"."bank_accounts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "currency_exchange_rates" ADD CONSTRAINT "currency_exchange_rates_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "erp_connectors" ADD CONSTRAINT "erp_connectors_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "erp_invoices" ADD CONSTRAINT "erp_invoices_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "erp_invoices" ADD CONSTRAINT "erp_invoices_connector_id_erp_connectors_id_fk" FOREIGN KEY ("connector_id") REFERENCES "public"."erp_connectors"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "financial_audit_log" ADD CONSTRAINT "financial_audit_log_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "journal_entries" ADD CONSTRAINT "journal_entries_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "journal_entries" ADD CONSTRAINT "journal_entries_connector_id_erp_connectors_id_fk" FOREIGN KEY ("connector_id") REFERENCES "public"."erp_connectors"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "journal_entry_lines" ADD CONSTRAINT "journal_entry_lines_entry_id_journal_entries_id_fk" FOREIGN KEY ("entry_id") REFERENCES "public"."journal_entries"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "journal_entry_lines" ADD CONSTRAINT "journal_entry_lines_account_id_chart_of_accounts_id_fk" FOREIGN KEY ("account_id") REFERENCES "public"."chart_of_accounts"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "sync_jobs" ADD CONSTRAINT "sync_jobs_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "sync_jobs" ADD CONSTRAINT "sync_jobs_connector_id_erp_connectors_id_fk" FOREIGN KEY ("connector_id") REFERENCES "public"."erp_connectors"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "clc_api_config" ADD CONSTRAINT "clc_api_config_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "clc_remittance_mapping" ADD CONSTRAINT "clc_remittance_mapping_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "clc_organization_sync_log" ADD CONSTRAINT "clc_organization_sync_log_organization_id_fkey" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_accounts" ADD CONSTRAINT "social_accounts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_accounts" ADD CONSTRAINT "social_accounts_connected_by_profiles_user_id_fk" FOREIGN KEY ("connected_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_analytics" ADD CONSTRAINT "social_analytics_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_analytics" ADD CONSTRAINT "social_analytics_account_id_social_accounts_id_fk" FOREIGN KEY ("account_id") REFERENCES "public"."social_accounts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_campaigns" ADD CONSTRAINT "social_campaigns_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_campaigns" ADD CONSTRAINT "social_campaigns_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_engagement" ADD CONSTRAINT "social_engagement_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_engagement" ADD CONSTRAINT "social_engagement_post_id_social_posts_id_fk" FOREIGN KEY ("post_id") REFERENCES "public"."social_posts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_feeds" ADD CONSTRAINT "social_feeds_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_feeds" ADD CONSTRAINT "social_feeds_account_id_social_accounts_id_fk" FOREIGN KEY ("account_id") REFERENCES "public"."social_accounts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_posts" ADD CONSTRAINT "social_posts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_posts" ADD CONSTRAINT "social_posts_account_id_social_accounts_id_fk" FOREIGN KEY ("account_id") REFERENCES "public"."social_accounts"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_posts" ADD CONSTRAINT "social_posts_campaign_id_social_campaigns_id_fk" FOREIGN KEY ("campaign_id") REFERENCES "public"."social_campaigns"("id") ON DELETE set null ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "social_posts" ADD CONSTRAINT "social_posts_created_by_profiles_user_id_fk" FOREIGN KEY ("created_by") REFERENCES "public"."profiles"("user_id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "ticket_comments" ADD CONSTRAINT "ticket_comments_ticket_id_support_tickets_id_fk" FOREIGN KEY ("ticket_id") REFERENCES "public"."support_tickets"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "ticket_history" ADD CONSTRAINT "ticket_history_ticket_id_support_tickets_id_fk" FOREIGN KEY ("ticket_id") REFERENCES "public"."support_tickets"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "integration_configs" ADD CONSTRAINT "integration_configs_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "integration_sync_log" ADD CONSTRAINT "integration_sync_log_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "integration_sync_schedules" ADD CONSTRAINT "integration_sync_schedules_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "webhook_events" ADD CONSTRAINT "webhook_events_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
CREATE INDEX "idx_grievance_approvals_organization" ON "grievance_approvals" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_grievance_approvals_transition" ON "grievance_approvals" USING btree ("transition_id");--> statement-breakpoint
CREATE INDEX "idx_grievance_approvals_approver" ON "grievance_approvals" USING btree ("approver_user_id");--> statement-breakpoint
CREATE INDEX "idx_grievance_approvals_action" ON "grievance_approvals" USING btree ("action");--> statement-breakpoint
CREATE INDEX "idx_grievance_approvals_reviewed_at" ON "grievance_approvals" USING btree ("reviewed_at");--> statement-breakpoint
CREATE INDEX "bargaining_proposals_negotiation_idx" ON "bargaining_proposals" USING btree ("negotiation_id");--> statement-breakpoint
CREATE INDEX "bargaining_proposals_status_idx" ON "bargaining_proposals" USING btree ("status");--> statement-breakpoint
CREATE INDEX "bargaining_proposals_type_idx" ON "bargaining_proposals" USING btree ("proposal_type");--> statement-breakpoint
CREATE INDEX "bargaining_proposals_category_idx" ON "bargaining_proposals" USING btree ("clause_category");--> statement-breakpoint
CREATE INDEX "bargaining_proposals_number_idx" ON "bargaining_proposals" USING btree ("proposal_number");--> statement-breakpoint
CREATE INDEX "bargaining_team_negotiation_idx" ON "bargaining_team_members" USING btree ("negotiation_id");--> statement-breakpoint
CREATE INDEX "bargaining_team_member_idx" ON "bargaining_team_members" USING btree ("member_id");--> statement-breakpoint
CREATE INDEX "bargaining_team_role_idx" ON "bargaining_team_members" USING btree ("role");--> statement-breakpoint
CREATE INDEX "bargaining_team_active_idx" ON "bargaining_team_members" USING btree ("is_active");--> statement-breakpoint
CREATE INDEX "negotiation_sessions_negotiation_idx" ON "negotiation_sessions" USING btree ("negotiation_id");--> statement-breakpoint
CREATE INDEX "negotiation_sessions_scheduled_idx" ON "negotiation_sessions" USING btree ("scheduled_date");--> statement-breakpoint
CREATE INDEX "negotiation_sessions_number_idx" ON "negotiation_sessions" USING btree ("session_number");--> statement-breakpoint
CREATE INDEX "negotiation_sessions_status_idx" ON "negotiation_sessions" USING btree ("status");--> statement-breakpoint
CREATE INDEX "negotiations_organization_idx" ON "negotiations" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "negotiations_status_idx" ON "negotiations" USING btree ("status");--> statement-breakpoint
CREATE INDEX "negotiations_expiring_cba_idx" ON "negotiations" USING btree ("expiring_cba_id");--> statement-breakpoint
CREATE INDEX "negotiations_first_session_idx" ON "negotiations" USING btree ("first_session_date");--> statement-breakpoint
CREATE INDEX "tentative_agreements_negotiation_idx" ON "tentative_agreements" USING btree ("negotiation_id");--> statement-breakpoint
CREATE INDEX "tentative_agreements_category_idx" ON "tentative_agreements" USING btree ("clause_category");--> statement-breakpoint
CREATE INDEX "tentative_agreements_ratified_idx" ON "tentative_agreements" USING btree ("ratified");--> statement-breakpoint
CREATE INDEX "bank_reconciliation_org_idx" ON "bank_reconciliation" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "bank_reconciliation_status_idx" ON "bank_reconciliation" USING btree ("status");--> statement-breakpoint
CREATE INDEX "bank_reconciliation_deposit_idx" ON "bank_reconciliation" USING btree ("bank_deposit_id");--> statement-breakpoint
CREATE INDEX "payment_cycles_org_idx" ON "payment_cycles" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "payment_cycles_status_idx" ON "payment_cycles" USING btree ("is_active");--> statement-breakpoint
CREATE INDEX "payment_disputes_org_idx" ON "payment_disputes" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "payment_disputes_payment_idx" ON "payment_disputes" USING btree ("payment_id");--> statement-breakpoint
CREATE INDEX "payment_disputes_status_idx" ON "payment_disputes" USING btree ("status");--> statement-breakpoint
CREATE INDEX "payment_methods_org_member_idx" ON "payment_methods" USING btree ("organization_id","member_id");--> statement-breakpoint
CREATE INDEX "payment_methods_stripe_idx" ON "payment_methods" USING btree ("stripe_payment_method_id");--> statement-breakpoint
CREATE INDEX "payments_org_idx" ON "payments" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "payments_member_idx" ON "payments" USING btree ("member_id");--> statement-breakpoint
CREATE INDEX "payments_status_idx" ON "payments" USING btree ("status");--> statement-breakpoint
CREATE INDEX "payments_method_idx" ON "payments" USING btree ("method");--> statement-breakpoint
CREATE INDEX "payments_stripe_idx" ON "payments" USING btree ("stripe_payment_intent_id");--> statement-breakpoint
CREATE INDEX "payments_reconciliation_idx" ON "payments" USING btree ("reconciliation_status");--> statement-breakpoint
CREATE INDEX "stripe_webhook_events_org_idx" ON "stripe_webhook_events" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "stripe_webhook_events_stripe_idx" ON "stripe_webhook_events" USING btree ("stripe_event_id");--> statement-breakpoint
CREATE INDEX "stripe_webhook_events_processed_idx" ON "stripe_webhook_events" USING btree ("processed");--> statement-breakpoint
CREATE INDEX "chart_of_accounts_org_idx" ON "chart_of_accounts" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "chart_of_accounts_number_idx" ON "chart_of_accounts" USING btree ("account_number","organization_id");--> statement-breakpoint
CREATE INDEX "chart_of_accounts_type_idx" ON "chart_of_accounts" USING btree ("type");--> statement-breakpoint
CREATE INDEX "chart_of_accounts_status_idx" ON "chart_of_accounts" USING btree ("status");--> statement-breakpoint
CREATE INDEX "chart_of_accounts_parent_idx" ON "chart_of_accounts" USING btree ("parent_account_id");--> statement-breakpoint
CREATE INDEX "cost_centers_org_idx" ON "cost_centers" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "cost_centers_code_idx" ON "cost_centers" USING btree ("code","organization_id");--> statement-breakpoint
CREATE INDEX "cost_centers_type_idx" ON "cost_centers" USING btree ("type");--> statement-breakpoint
CREATE INDEX "cost_centers_status_idx" ON "cost_centers" USING btree ("status");--> statement-breakpoint
CREATE INDEX "gl_account_mappings_org_idx" ON "gl_account_mappings" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "gl_account_mappings_chart_idx" ON "gl_account_mappings" USING btree ("chart_of_accounts_id");--> statement-breakpoint
CREATE INDEX "gl_account_mappings_local_type_idx" ON "gl_account_mappings" USING btree ("local_account_type");--> statement-breakpoint
CREATE INDEX "gl_account_mappings_gl_idx" ON "gl_account_mappings" USING btree ("gl_account_number");--> statement-breakpoint
CREATE INDEX "gl_transaction_log_org_idx" ON "gl_transaction_log" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "gl_transaction_log_chart_idx" ON "gl_transaction_log" USING btree ("chart_of_accounts_id");--> statement-breakpoint
CREATE INDEX "gl_transaction_log_date_idx" ON "gl_transaction_log" USING btree ("transaction_date");--> statement-breakpoint
CREATE INDEX "gl_transaction_log_number_idx" ON "gl_transaction_log" USING btree ("transaction_number");--> statement-breakpoint
CREATE INDEX "gl_transaction_log_posted_idx" ON "gl_transaction_log" USING btree ("is_posted");--> statement-breakpoint
CREATE INDEX "gl_transaction_log_reconciled_idx" ON "gl_transaction_log" USING btree ("is_reconciled");--> statement-breakpoint
CREATE INDEX "gl_trial_balance_org_idx" ON "gl_trial_balance" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "gl_trial_balance_chart_idx" ON "gl_trial_balance" USING btree ("chart_of_accounts_id");--> statement-breakpoint
CREATE INDEX "gl_trial_balance_date_idx" ON "gl_trial_balance" USING btree ("period_end_date");--> statement-breakpoint
CREATE INDEX "gl_trial_balance_finalized_idx" ON "gl_trial_balance" USING btree ("is_finalized");--> statement-breakpoint
CREATE INDEX "signature_audit_log_workflow_idx" ON "signature_audit_log" USING btree ("workflow_id");--> statement-breakpoint
CREATE INDEX "signature_audit_log_signer_idx" ON "signature_audit_log" USING btree ("signer_id");--> statement-breakpoint
CREATE INDEX "signature_audit_log_event_type_idx" ON "signature_audit_log" USING btree ("event_type");--> statement-breakpoint
CREATE INDEX "signature_verification_workflow_idx" ON "signature_verification" USING btree ("workflow_id");--> statement-breakpoint
CREATE INDEX "signature_verification_signer_idx" ON "signature_verification" USING btree ("signer_id");--> statement-breakpoint
CREATE INDEX "signature_verification_verified_idx" ON "signature_verification" USING btree ("is_verified");--> statement-breakpoint
CREATE INDEX "signature_workflows_org_idx" ON "signature_workflows" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "signature_workflows_doc_idx" ON "signature_workflows" USING btree ("document_id");--> statement-breakpoint
CREATE INDEX "signature_workflows_status_idx" ON "signature_workflows" USING btree ("status");--> statement-breakpoint
CREATE INDEX "signature_workflows_envelope_idx" ON "signature_workflows" USING btree ("external_envelope_id");--> statement-breakpoint
CREATE INDEX "signers_workflow_idx" ON "signers" USING btree ("workflow_id");--> statement-breakpoint
CREATE INDEX "signers_member_idx" ON "signers" USING btree ("member_id");--> statement-breakpoint
CREATE INDEX "signers_email_idx" ON "signers" USING btree ("email");--> statement-breakpoint
CREATE INDEX "signers_status_idx" ON "signers" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_congress_memberships_org_id" ON "congress_memberships" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_congress_memberships_congress_id" ON "congress_memberships" USING btree ("congress_id");--> statement-breakpoint
CREATE INDEX "idx_congress_memberships_status" ON "congress_memberships" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_congress_memberships_joined_at" ON "congress_memberships" USING btree ("joined_at");--> statement-breakpoint
CREATE UNIQUE INDEX "congress_memberships_org_congress_unique" ON "congress_memberships" USING btree ("organization_id","congress_id");--> statement-breakpoint
CREATE INDEX "external_accounts_org_provider_idx" ON "external_accounts" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_accounts_external_id_idx" ON "external_accounts" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "external_accounts_type_idx" ON "external_accounts" USING btree ("account_type");--> statement-breakpoint
CREATE INDEX "external_accounts_classification_idx" ON "external_accounts" USING btree ("classification");--> statement-breakpoint
CREATE INDEX "external_accounts_active_idx" ON "external_accounts" USING btree ("is_active");--> statement-breakpoint
CREATE INDEX "external_customers_org_provider_idx" ON "external_customers" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_customers_external_id_idx" ON "external_customers" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "external_customers_name_idx" ON "external_customers" USING btree ("name");--> statement-breakpoint
CREATE INDEX "external_customers_email_idx" ON "external_customers" USING btree ("email");--> statement-breakpoint
CREATE INDEX "external_invoices_org_provider_idx" ON "external_invoices" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_invoices_external_id_idx" ON "external_invoices" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "external_invoices_invoice_number_idx" ON "external_invoices" USING btree ("invoice_number");--> statement-breakpoint
CREATE INDEX "external_invoices_customer_idx" ON "external_invoices" USING btree ("customer_id");--> statement-breakpoint
CREATE INDEX "external_invoices_status_idx" ON "external_invoices" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_invoices_date_idx" ON "external_invoices" USING btree ("invoice_date");--> statement-breakpoint
CREATE INDEX "external_payments_org_provider_idx" ON "external_payments" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_payments_external_id_idx" ON "external_payments" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "external_payments_customer_idx" ON "external_payments" USING btree ("customer_id");--> statement-breakpoint
CREATE INDEX "external_payments_date_idx" ON "external_payments" USING btree ("payment_date");--> statement-breakpoint
CREATE INDEX "external_benefit_coverage_org_provider_idx" ON "external_benefit_coverage" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_benefit_coverage_employee_idx" ON "external_benefit_coverage" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_benefit_coverage_plan_idx" ON "external_benefit_coverage" USING btree ("plan_id");--> statement-breakpoint
CREATE INDEX "external_benefit_coverage_status_idx" ON "external_benefit_coverage" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_benefit_dependents_org_provider_idx" ON "external_benefit_dependents" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_benefit_dependents_employee_idx" ON "external_benefit_dependents" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_benefit_dependents_status_idx" ON "external_benefit_dependents" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_benefit_enrollments_org_provider_idx" ON "external_benefit_enrollments" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_benefit_enrollments_employee_idx" ON "external_benefit_enrollments" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_benefit_enrollments_plan_idx" ON "external_benefit_enrollments" USING btree ("plan_id");--> statement-breakpoint
CREATE INDEX "external_benefit_enrollments_status_idx" ON "external_benefit_enrollments" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_benefit_enrollments_effective_date_idx" ON "external_benefit_enrollments" USING btree ("effective_date");--> statement-breakpoint
CREATE INDEX "external_benefit_plans_org_provider_idx" ON "external_benefit_plans" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_benefit_plans_external_id_idx" ON "external_benefit_plans" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "external_benefit_plans_status_idx" ON "external_benefit_plans" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_benefit_plans_plan_type_idx" ON "external_benefit_plans" USING btree ("plan_type");--> statement-breakpoint
CREATE INDEX "external_benefit_plans_effective_date_idx" ON "external_benefit_plans" USING btree ("effective_date");--> statement-breakpoint
CREATE INDEX "external_benefit_utilization_org_provider_idx" ON "external_benefit_utilization" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_benefit_utilization_employee_idx" ON "external_benefit_utilization" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_benefit_utilization_policy_idx" ON "external_benefit_utilization" USING btree ("policy_id");--> statement-breakpoint
CREATE INDEX "external_benefit_utilization_period_idx" ON "external_benefit_utilization" USING btree ("period_start","period_end");--> statement-breakpoint
CREATE INDEX "external_insurance_beneficiaries_org_provider_idx" ON "external_insurance_beneficiaries" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_insurance_beneficiaries_policy_idx" ON "external_insurance_beneficiaries" USING btree ("policy_id");--> statement-breakpoint
CREATE INDEX "external_insurance_beneficiaries_employee_idx" ON "external_insurance_beneficiaries" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_insurance_beneficiaries_status_idx" ON "external_insurance_beneficiaries" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_insurance_claims_org_provider_idx" ON "external_insurance_claims" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_insurance_claims_claim_number_idx" ON "external_insurance_claims" USING btree ("claim_number");--> statement-breakpoint
CREATE INDEX "external_insurance_claims_employee_idx" ON "external_insurance_claims" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_insurance_claims_status_idx" ON "external_insurance_claims" USING btree ("status");--> statement-breakpoint
CREATE INDEX "external_insurance_claims_submission_date_idx" ON "external_insurance_claims" USING btree ("submission_date");--> statement-breakpoint
CREATE INDEX "external_insurance_claims_claim_type_idx" ON "external_insurance_claims" USING btree ("claim_type");--> statement-breakpoint
CREATE INDEX "external_insurance_policies_org_provider_idx" ON "external_insurance_policies" USING btree ("organization_id","external_provider");--> statement-breakpoint
CREATE INDEX "external_insurance_policies_policy_number_idx" ON "external_insurance_policies" USING btree ("policy_number");--> statement-breakpoint
CREATE INDEX "external_insurance_policies_employee_idx" ON "external_insurance_policies" USING btree ("employee_id");--> statement-breakpoint
CREATE INDEX "external_insurance_policies_status_idx" ON "external_insurance_policies" USING btree ("status");--> statement-breakpoint
CREATE INDEX "comm_channels_org_id_idx" ON "external_communication_channels" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "comm_channels_provider_idx" ON "external_communication_channels" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "comm_channels_external_id_idx" ON "external_communication_channels" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "comm_channels_type_idx" ON "external_communication_channels" USING btree ("channel_type");--> statement-breakpoint
CREATE INDEX "comm_channels_archived_idx" ON "external_communication_channels" USING btree ("is_archived");--> statement-breakpoint
CREATE INDEX "comm_channels_last_sync_idx" ON "external_communication_channels" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "comm_files_org_id_idx" ON "external_communication_files" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "comm_files_provider_idx" ON "external_communication_files" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "comm_files_channel_id_idx" ON "external_communication_files" USING btree ("channel_id");--> statement-breakpoint
CREATE INDEX "comm_files_user_id_idx" ON "external_communication_files" USING btree ("user_id");--> statement-breakpoint
CREATE INDEX "comm_files_file_type_idx" ON "external_communication_files" USING btree ("file_type");--> statement-breakpoint
CREATE INDEX "comm_files_created_at_idx" ON "external_communication_files" USING btree ("created_at");--> statement-breakpoint
CREATE INDEX "comm_files_last_sync_idx" ON "external_communication_files" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "comm_messages_org_id_idx" ON "external_communication_messages" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "comm_messages_provider_idx" ON "external_communication_messages" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "comm_messages_channel_id_idx" ON "external_communication_messages" USING btree ("channel_id");--> statement-breakpoint
CREATE INDEX "comm_messages_user_id_idx" ON "external_communication_messages" USING btree ("user_id");--> statement-breakpoint
CREATE INDEX "comm_messages_timestamp_idx" ON "external_communication_messages" USING btree ("timestamp");--> statement-breakpoint
CREATE INDEX "comm_messages_thread_id_idx" ON "external_communication_messages" USING btree ("thread_id");--> statement-breakpoint
CREATE INDEX "comm_messages_last_sync_idx" ON "external_communication_messages" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "comm_users_org_id_idx" ON "external_communication_users" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "comm_users_provider_idx" ON "external_communication_users" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "comm_users_external_id_idx" ON "external_communication_users" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "comm_users_email_idx" ON "external_communication_users" USING btree ("email");--> statement-breakpoint
CREATE INDEX "comm_users_username_idx" ON "external_communication_users" USING btree ("username");--> statement-breakpoint
CREATE INDEX "comm_users_is_bot_idx" ON "external_communication_users" USING btree ("is_bot");--> statement-breakpoint
CREATE INDEX "comm_users_last_sync_idx" ON "external_communication_users" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "lms_completions_org_id_idx" ON "external_lms_completions" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "lms_completions_provider_idx" ON "external_lms_completions" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "lms_completions_course_id_idx" ON "external_lms_completions" USING btree ("course_id");--> statement-breakpoint
CREATE INDEX "lms_completions_learner_id_idx" ON "external_lms_completions" USING btree ("learner_id");--> statement-breakpoint
CREATE INDEX "lms_completions_completed_at_idx" ON "external_lms_completions" USING btree ("completed_at");--> statement-breakpoint
CREATE INDEX "lms_completions_last_sync_idx" ON "external_lms_completions" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "lms_courses_org_id_idx" ON "external_lms_courses" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "lms_courses_provider_idx" ON "external_lms_courses" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "lms_courses_external_id_idx" ON "external_lms_courses" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "lms_courses_difficulty_idx" ON "external_lms_courses" USING btree ("difficulty_level");--> statement-breakpoint
CREATE INDEX "lms_courses_last_sync_idx" ON "external_lms_courses" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "lms_enrollments_org_id_idx" ON "external_lms_enrollments" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "lms_enrollments_provider_idx" ON "external_lms_enrollments" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "lms_enrollments_course_id_idx" ON "external_lms_enrollments" USING btree ("course_id");--> statement-breakpoint
CREATE INDEX "lms_enrollments_learner_id_idx" ON "external_lms_enrollments" USING btree ("learner_id");--> statement-breakpoint
CREATE INDEX "lms_enrollments_status_idx" ON "external_lms_enrollments" USING btree ("status");--> statement-breakpoint
CREATE INDEX "lms_enrollments_last_sync_idx" ON "external_lms_enrollments" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "lms_learners_org_id_idx" ON "external_lms_learners" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "lms_learners_provider_idx" ON "external_lms_learners" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "lms_learners_external_id_idx" ON "external_lms_learners" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "lms_learners_email_idx" ON "external_lms_learners" USING btree ("email");--> statement-breakpoint
CREATE INDEX "lms_learners_last_sync_idx" ON "external_lms_learners" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "lms_progress_org_id_idx" ON "external_lms_progress" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "lms_progress_provider_idx" ON "external_lms_progress" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "lms_progress_course_id_idx" ON "external_lms_progress" USING btree ("course_id");--> statement-breakpoint
CREATE INDEX "lms_progress_learner_id_idx" ON "external_lms_progress" USING btree ("learner_id");--> statement-breakpoint
CREATE INDEX "lms_progress_last_sync_idx" ON "external_lms_progress" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "doc_files_org_id_idx" ON "external_document_files" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "doc_files_provider_idx" ON "external_document_files" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "doc_files_library_id_idx" ON "external_document_files" USING btree ("library_id");--> statement-breakpoint
CREATE INDEX "doc_files_is_folder_idx" ON "external_document_files" USING btree ("is_folder");--> statement-breakpoint
CREATE INDEX "doc_files_created_by_email_idx" ON "external_document_files" USING btree ("created_by_email");--> statement-breakpoint
CREATE INDEX "doc_files_last_modified_at_idx" ON "external_document_files" USING btree ("last_modified_at");--> statement-breakpoint
CREATE INDEX "doc_files_last_sync_idx" ON "external_document_files" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "doc_libraries_org_id_idx" ON "external_document_libraries" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "doc_libraries_provider_idx" ON "external_document_libraries" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "doc_libraries_external_id_idx" ON "external_document_libraries" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "doc_libraries_site_id_idx" ON "external_document_libraries" USING btree ("site_id");--> statement-breakpoint
CREATE INDEX "doc_libraries_last_sync_idx" ON "external_document_libraries" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "doc_permissions_org_id_idx" ON "external_document_permissions" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "doc_permissions_provider_idx" ON "external_document_permissions" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "doc_permissions_file_id_idx" ON "external_document_permissions" USING btree ("file_id");--> statement-breakpoint
CREATE INDEX "doc_permissions_user_id_idx" ON "external_document_permissions" USING btree ("user_id");--> statement-breakpoint
CREATE INDEX "doc_permissions_group_id_idx" ON "external_document_permissions" USING btree ("group_id");--> statement-breakpoint
CREATE INDEX "doc_permissions_last_sync_idx" ON "external_document_permissions" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "doc_sites_org_id_idx" ON "external_document_sites" USING btree ("org_id");--> statement-breakpoint
CREATE INDEX "doc_sites_provider_idx" ON "external_document_sites" USING btree ("external_provider");--> statement-breakpoint
CREATE INDEX "doc_sites_external_id_idx" ON "external_document_sites" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "doc_sites_last_sync_idx" ON "external_document_sites" USING btree ("last_synced_at");--> statement-breakpoint
CREATE INDEX "idx_model_metadata_organization" ON "model_metadata" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_model_metadata_type" ON "model_metadata" USING btree ("model_type");--> statement-breakpoint
CREATE INDEX "idx_alert_actions_rule" ON "alert_actions" USING btree ("alert_rule_id","order_index");--> statement-breakpoint
CREATE INDEX "idx_alert_conditions_rule" ON "alert_conditions" USING btree ("alert_rule_id","order_index");--> statement-breakpoint
CREATE INDEX "idx_alert_escalations_organization" ON "alert_escalations" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_alert_escalations_rule" ON "alert_escalations" USING btree ("alert_rule_id");--> statement-breakpoint
CREATE INDEX "idx_alert_escalations_status" ON "alert_escalations" USING btree ("status","next_escalation_at");--> statement-breakpoint
CREATE INDEX "idx_alert_executions_rule" ON "alert_executions" USING btree ("alert_rule_id","created_at");--> statement-breakpoint
CREATE INDEX "idx_alert_executions_status" ON "alert_executions" USING btree ("status","started_at");--> statement-breakpoint
CREATE INDEX "idx_alert_executions_created" ON "alert_executions" USING btree ("created_at");--> statement-breakpoint
CREATE INDEX "idx_alert_recipients_rule" ON "alert_recipients" USING btree ("alert_rule_id");--> statement-breakpoint
CREATE INDEX "idx_alert_recipients_type" ON "alert_recipients" USING btree ("recipient_type","recipient_id");--> statement-breakpoint
CREATE INDEX "idx_alert_rules_organization" ON "alert_rules" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_alert_rules_category" ON "alert_rules" USING btree ("category");--> statement-breakpoint
CREATE INDEX "idx_alert_rules_trigger" ON "alert_rules" USING btree ("trigger_type");--> statement-breakpoint
CREATE INDEX "idx_alert_rules_next_execution" ON "alert_rules" USING btree ("last_executed_at");--> statement-breakpoint
CREATE INDEX "idx_workflow_definitions_organization" ON "workflow_definitions" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_workflow_definitions_trigger" ON "workflow_definitions" USING btree ("trigger_type");--> statement-breakpoint
CREATE INDEX "idx_workflow_definitions_category" ON "workflow_definitions" USING btree ("category");--> statement-breakpoint
CREATE INDEX "idx_workflow_executions_workflow" ON "workflow_executions" USING btree ("workflow_definition_id","created_at");--> statement-breakpoint
CREATE INDEX "idx_workflow_executions_organization" ON "workflow_executions" USING btree ("organization_id","status");--> statement-breakpoint
CREATE INDEX "idx_workflow_executions_status" ON "workflow_executions" USING btree ("status","started_at");--> statement-breakpoint
CREATE INDEX "idx_card_signing_organization" ON "card_signing_events" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_card_signing_campaign" ON "card_signing_events" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_card_signing_contact" ON "card_signing_events" USING btree ("contact_id");--> statement-breakpoint
CREATE INDEX "idx_card_signing_date" ON "card_signing_events" USING btree ("signed_date");--> statement-breakpoint
CREATE INDEX "idx_card_signing_status" ON "card_signing_events" USING btree ("card_status");--> statement-breakpoint
CREATE INDEX "idx_card_signing_submitted" ON "card_signing_events" USING btree ("submitted_to_nlrb_clrb");--> statement-breakpoint
CREATE INDEX "idx_employer_responses_organization" ON "employer_responses" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_employer_responses_campaign" ON "employer_responses" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_employer_responses_date" ON "employer_responses" USING btree ("response_date");--> statement-breakpoint
CREATE INDEX "idx_employer_responses_type" ON "employer_responses" USING btree ("response_type");--> statement-breakpoint
CREATE INDEX "idx_employer_responses_severity" ON "employer_responses" USING btree ("response_severity");--> statement-breakpoint
CREATE INDEX "idx_field_activities_organization" ON "field_organizer_activities" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_field_activities_campaign" ON "field_organizer_activities" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_field_activities_organizer" ON "field_organizer_activities" USING btree ("organizer_id");--> statement-breakpoint
CREATE INDEX "idx_field_activities_contact" ON "field_organizer_activities" USING btree ("contact_id");--> statement-breakpoint
CREATE INDEX "idx_field_activities_date" ON "field_organizer_activities" USING btree ("activity_date");--> statement-breakpoint
CREATE INDEX "idx_field_activities_type" ON "field_organizer_activities" USING btree ("activity_type");--> statement-breakpoint
CREATE INDEX "idx_nlrb_clrb_organization" ON "nlrb_clrb_filings" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_nlrb_clrb_campaign" ON "nlrb_clrb_filings" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_nlrb_clrb_status" ON "nlrb_clrb_filings" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_nlrb_clrb_filing_number" ON "nlrb_clrb_filings" USING btree ("filing_number");--> statement-breakpoint
CREATE INDEX "idx_nlrb_clrb_jurisdiction" ON "nlrb_clrb_filings" USING btree ("jurisdiction");--> statement-breakpoint
CREATE INDEX "idx_nlrb_clrb_election_date" ON "nlrb_clrb_filings" USING btree ("election_scheduled_date");--> statement-breakpoint
CREATE INDEX "idx_campaign_milestones_organization" ON "organizing_campaign_milestones" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_campaign_milestones_campaign" ON "organizing_campaign_milestones" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_campaign_milestones_target_date" ON "organizing_campaign_milestones" USING btree ("target_date");--> statement-breakpoint
CREATE INDEX "idx_campaign_milestones_status" ON "organizing_campaign_milestones" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_organizing_campaigns_organization" ON "organizing_campaigns" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_organizing_campaigns_status" ON "organizing_campaigns" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_organizing_campaigns_lead" ON "organizing_campaigns" USING btree ("lead_organizer_id");--> statement-breakpoint
CREATE INDEX "idx_organizing_campaigns_employer" ON "organizing_campaigns" USING btree ("target_employer");--> statement-breakpoint
CREATE INDEX "idx_organizing_campaigns_progress" ON "organizing_campaigns" USING btree ("card_signing_progress");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_organization" ON "organizing_contacts" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_campaign" ON "organizing_contacts" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_commitment" ON "organizing_contacts" USING btree ("commitment_level");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_card_signed" ON "organizing_contacts" USING btree ("card_signed");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_name" ON "organizing_contacts" USING btree ("last_name","first_name");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_department" ON "organizing_contacts" USING btree ("campaign_id","department");--> statement-breakpoint
CREATE INDEX "idx_organizing_contacts_influence" ON "organizing_contacts" USING btree ("campaign_id","influence_level");--> statement-breakpoint
CREATE INDEX "idx_union_votes_organization" ON "union_representation_votes" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_union_votes_campaign" ON "union_representation_votes" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_union_votes_filing" ON "union_representation_votes" USING btree ("filing_id");--> statement-breakpoint
CREATE INDEX "idx_union_votes_date" ON "union_representation_votes" USING btree ("vote_date");--> statement-breakpoint
CREATE INDEX "idx_union_votes_result" ON "union_representation_votes" USING btree ("result");--> statement-breakpoint
CREATE INDEX "idx_cms_media_organization" ON "cms_media_library" USING btree ("organization_id","file_type");--> statement-breakpoint
CREATE INDEX "idx_cms_media_tags" ON "cms_media_library" USING btree ("tags");--> statement-breakpoint
CREATE UNIQUE INDEX "cms_navigation_organization_location_unique" ON "cms_navigation_menus" USING btree ("organization_id","location");--> statement-breakpoint
CREATE UNIQUE INDEX "cms_pages_organization_slug_unique" ON "cms_pages" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_cms_pages_organization_status" ON "cms_pages" USING btree ("organization_id","status");--> statement-breakpoint
CREATE INDEX "idx_cms_pages_slug" ON "cms_pages" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_cms_pages_published" ON "cms_pages" USING btree ("organization_id","published_at");--> statement-breakpoint
CREATE INDEX "idx_cms_templates_organization" ON "cms_templates" USING btree ("organization_id");--> statement-breakpoint
CREATE UNIQUE INDEX "donation_campaigns_organization_slug_unique" ON "donation_campaigns" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_donation_campaigns_slug" ON "donation_campaigns" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_donation_campaigns_status" ON "donation_campaigns" USING btree ("organization_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX "donation_receipts_organization_number_unique" ON "donation_receipts" USING btree ("organization_id","receipt_number");--> statement-breakpoint
CREATE INDEX "idx_donations_organization" ON "donations" USING btree ("organization_id","created_at");--> statement-breakpoint
CREATE INDEX "idx_donations_campaign" ON "donations" USING btree ("campaign_id","payment_status");--> statement-breakpoint
CREATE INDEX "idx_donations_email" ON "donations" USING btree ("donor_email");--> statement-breakpoint
CREATE INDEX "idx_event_registrations_event" ON "event_registrations" USING btree ("event_id","registration_status");--> statement-breakpoint
CREATE INDEX "idx_event_registrations_email" ON "event_registrations" USING btree ("email");--> statement-breakpoint
CREATE INDEX "idx_job_applications_job" ON "job_applications" USING btree ("job_posting_id","application_status");--> statement-breakpoint
CREATE INDEX "idx_job_applications_email" ON "job_applications" USING btree ("email");--> statement-breakpoint
CREATE UNIQUE INDEX "job_postings_organization_slug_unique" ON "job_postings" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_jobs_organization" ON "job_postings" USING btree ("organization_id","status","posted_date");--> statement-breakpoint
CREATE INDEX "idx_jobs_slug" ON "job_postings" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_jobs_category" ON "job_postings" USING btree ("category","status");--> statement-breakpoint
CREATE INDEX "idx_jobs_location" ON "job_postings" USING btree ("city","province","status");--> statement-breakpoint
CREATE INDEX "idx_jobs_featured" ON "job_postings" USING btree ("featured","status","posted_date");--> statement-breakpoint
CREATE UNIQUE INDEX "job_saved_profile_job_unique" ON "job_saved" USING btree ("profile_id","job_posting_id");--> statement-breakpoint
CREATE UNIQUE INDEX "page_analytics_organization_page_date_unique" ON "page_analytics" USING btree ("organization_id","page_id","metric_date");--> statement-breakpoint
CREATE UNIQUE INDEX "public_events_organization_slug_unique" ON "public_events" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_events_organization" ON "public_events" USING btree ("organization_id","start_date");--> statement-breakpoint
CREATE INDEX "idx_events_slug" ON "public_events" USING btree ("organization_id","slug");--> statement-breakpoint
CREATE INDEX "idx_events_status" ON "public_events" USING btree ("organization_id","registration_status");--> statement-breakpoint
CREATE INDEX "idx_events_dates" ON "public_events" USING btree ("start_date","end_date");--> statement-breakpoint
CREATE INDEX "bank_accounts_organization_idx" ON "bank_accounts" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "bank_recon_organization_idx" ON "bank_reconciliations" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "bank_recon_account_idx" ON "bank_reconciliations" USING btree ("bank_account_id");--> statement-breakpoint
CREATE INDEX "bank_recon_date_idx" ON "bank_reconciliations" USING btree ("statement_date");--> statement-breakpoint
CREATE INDEX "bank_txns_account_idx" ON "bank_transactions" USING btree ("bank_account_id");--> statement-breakpoint
CREATE INDEX "bank_txns_date_idx" ON "bank_transactions" USING btree ("transaction_date");--> statement-breakpoint
CREATE INDEX "bank_txns_reconciled_idx" ON "bank_transactions" USING btree ("is_reconciled");--> statement-breakpoint
CREATE INDEX "fx_rates_organization_idx" ON "currency_exchange_rates" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "fx_rates_currency_idx" ON "currency_exchange_rates" USING btree ("base_currency","target_currency");--> statement-breakpoint
CREATE INDEX "fx_rates_date_idx" ON "currency_exchange_rates" USING btree ("effective_date");--> statement-breakpoint
CREATE INDEX "erp_connectors_organization_idx" ON "erp_connectors" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "erp_connectors_system_type_idx" ON "erp_connectors" USING btree ("system_type");--> statement-breakpoint
CREATE INDEX "invoices_organization_idx" ON "erp_invoices" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "invoices_number_idx" ON "erp_invoices" USING btree ("invoice_number");--> statement-breakpoint
CREATE INDEX "invoices_status_idx" ON "erp_invoices" USING btree ("status");--> statement-breakpoint
CREATE INDEX "invoices_due_date_idx" ON "erp_invoices" USING btree ("due_date");--> statement-breakpoint
CREATE INDEX "audit_organization_idx" ON "financial_audit_log" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "audit_entity_idx" ON "financial_audit_log" USING btree ("entity_type","entity_id");--> statement-breakpoint
CREATE INDEX "audit_user_idx" ON "financial_audit_log" USING btree ("user_id");--> statement-breakpoint
CREATE INDEX "audit_timestamp_idx" ON "financial_audit_log" USING btree ("timestamp");--> statement-breakpoint
CREATE INDEX "je_organization_idx" ON "journal_entries" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "je_entry_number_idx" ON "journal_entries" USING btree ("entry_number");--> statement-breakpoint
CREATE INDEX "je_entry_date_idx" ON "journal_entries" USING btree ("entry_date");--> statement-breakpoint
CREATE INDEX "je_external_id_idx" ON "journal_entries" USING btree ("external_id");--> statement-breakpoint
CREATE INDEX "jel_entry_idx" ON "journal_entry_lines" USING btree ("entry_id");--> statement-breakpoint
CREATE INDEX "jel_account_idx" ON "journal_entry_lines" USING btree ("account_id");--> statement-breakpoint
CREATE INDEX "jel_member_idx" ON "journal_entry_lines" USING btree ("member_id");--> statement-breakpoint
CREATE INDEX "sync_jobs_organization_idx" ON "sync_jobs" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "sync_jobs_connector_idx" ON "sync_jobs" USING btree ("connector_id");--> statement-breakpoint
CREATE INDEX "sync_jobs_status_idx" ON "sync_jobs" USING btree ("status");--> statement-breakpoint
CREATE INDEX "sync_jobs_started_at_idx" ON "sync_jobs" USING btree ("started_at");--> statement-breakpoint
CREATE INDEX "clc_api_config_org_idx" ON "clc_api_config" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "clc_remittance_mapping_org_idx" ON "clc_remittance_mapping" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "clc_remittance_mapping_external_idx" ON "clc_remittance_mapping" USING btree ("external_remittance_id");--> statement-breakpoint
CREATE INDEX "idx_org_sync_log_org" ON "clc_organization_sync_log" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_org_sync_log_affiliate" ON "clc_organization_sync_log" USING btree ("affiliate_code");--> statement-breakpoint
CREATE INDEX "idx_org_sync_log_date" ON "clc_organization_sync_log" USING btree ("synced_at");--> statement-breakpoint
CREATE INDEX "idx_org_sync_log_action" ON "clc_organization_sync_log" USING btree ("action");--> statement-breakpoint
CREATE INDEX "idx_social_accounts_organization" ON "social_accounts" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_social_accounts_platform" ON "social_accounts" USING btree ("platform");--> statement-breakpoint
CREATE INDEX "idx_social_accounts_status" ON "social_accounts" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_social_accounts_primary" ON "social_accounts" USING btree ("organization_id","platform","is_primary");--> statement-breakpoint
CREATE INDEX "idx_social_analytics_organization" ON "social_analytics" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_social_analytics_account" ON "social_analytics" USING btree ("account_id");--> statement-breakpoint
CREATE INDEX "idx_social_analytics_date" ON "social_analytics" USING btree ("analytics_date");--> statement-breakpoint
CREATE INDEX "idx_social_analytics_account_date" ON "social_analytics" USING btree ("account_id","analytics_date");--> statement-breakpoint
CREATE INDEX "idx_social_campaigns_organization" ON "social_campaigns" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_social_campaigns_status" ON "social_campaigns" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_social_campaigns_dates" ON "social_campaigns" USING btree ("start_date","end_date");--> statement-breakpoint
CREATE INDEX "idx_social_engagement_organization" ON "social_engagement" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_social_engagement_post" ON "social_engagement" USING btree ("post_id");--> statement-breakpoint
CREATE INDEX "idx_social_engagement_type" ON "social_engagement" USING btree ("engagement_type");--> statement-breakpoint
CREATE INDEX "idx_social_engagement_engaged_at" ON "social_engagement" USING btree ("engaged_at");--> statement-breakpoint
CREATE INDEX "idx_social_engagement_sentiment" ON "social_engagement" USING btree ("sentiment");--> statement-breakpoint
CREATE INDEX "idx_social_feeds_organization" ON "social_feeds" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_social_feeds_account" ON "social_feeds" USING btree ("account_id");--> statement-breakpoint
CREATE INDEX "idx_social_feeds_published" ON "social_feeds" USING btree ("published_at");--> statement-breakpoint
CREATE INDEX "idx_social_posts_organization" ON "social_posts" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_social_posts_account" ON "social_posts" USING btree ("account_id");--> statement-breakpoint
CREATE INDEX "idx_social_posts_campaign" ON "social_posts" USING btree ("campaign_id");--> statement-breakpoint
CREATE INDEX "idx_social_posts_status" ON "social_posts" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_social_posts_scheduled" ON "social_posts" USING btree ("scheduled_for");--> statement-breakpoint
CREATE INDEX "idx_social_posts_published" ON "social_posts" USING btree ("published_at");--> statement-breakpoint
CREATE INDEX "idx_kb_articles_slug" ON "knowledge_base_articles" USING btree ("slug");--> statement-breakpoint
CREATE INDEX "idx_kb_articles_category" ON "knowledge_base_articles" USING btree ("category");--> statement-breakpoint
CREATE INDEX "idx_kb_articles_status" ON "knowledge_base_articles" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_kb_articles_published" ON "knowledge_base_articles" USING btree ("published_at");--> statement-breakpoint
CREATE INDEX "idx_sla_policies_name" ON "sla_policies" USING btree ("name");--> statement-breakpoint
CREATE INDEX "idx_sla_policies_priority" ON "sla_policies" USING btree ("priority");--> statement-breakpoint
CREATE INDEX "idx_sla_policies_active" ON "sla_policies" USING btree ("is_active");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_number" ON "support_tickets" USING btree ("ticket_number");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_org" ON "support_tickets" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_status" ON "support_tickets" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_priority" ON "support_tickets" USING btree ("priority");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_assigned" ON "support_tickets" USING btree ("assigned_to_user_id");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_category" ON "support_tickets" USING btree ("category");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_created" ON "support_tickets" USING btree ("created_at");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_sla_response" ON "support_tickets" USING btree ("sla_response_by");--> statement-breakpoint
CREATE INDEX "idx_support_tickets_sla_resolve" ON "support_tickets" USING btree ("sla_resolve_by");--> statement-breakpoint
CREATE INDEX "idx_ticket_comments_ticket" ON "ticket_comments" USING btree ("ticket_id");--> statement-breakpoint
CREATE INDEX "idx_ticket_comments_created" ON "ticket_comments" USING btree ("created_at");--> statement-breakpoint
CREATE INDEX "idx_ticket_history_ticket" ON "ticket_history" USING btree ("ticket_id");--> statement-breakpoint
CREATE INDEX "idx_ticket_history_created" ON "ticket_history" USING btree ("created_at");--> statement-breakpoint
CREATE INDEX "idx_ticket_history_action" ON "ticket_history" USING btree ("action");--> statement-breakpoint
ALTER TABLE "in_app_notifications" ADD CONSTRAINT "in_app_notifications_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "notification_bounces" ADD CONSTRAINT "notification_bounces_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "notification_delivery_log" ADD CONSTRAINT "notification_delivery_log_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "notification_history" ADD CONSTRAINT "notification_history_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "notification_queue" ADD CONSTRAINT "notification_queue_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "notification_templates" ADD CONSTRAINT "notification_templates_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "notifications" ADD CONSTRAINT "notifications_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "user_notification_preferences" ADD CONSTRAINT "user_notification_preferences_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "calendar_events" ADD CONSTRAINT "calendar_events_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "calendar_sharing" ADD CONSTRAINT "calendar_sharing_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "calendars" ADD CONSTRAINT "calendars_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_attendees" ADD CONSTRAINT "event_attendees_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "event_reminders" ADD CONSTRAINT "event_reminders_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "external_calendar_connections" ADD CONSTRAINT "external_calendar_connections_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "meeting_rooms" ADD CONSTRAINT "meeting_rooms_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "room_bookings" ADD CONSTRAINT "room_bookings_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "deadline_alerts" ADD CONSTRAINT "deadline_alerts_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "deadline_extensions" ADD CONSTRAINT "deadline_extensions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "deadline_rules" ADD CONSTRAINT "deadline_rules_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "claim_deadlines" ADD CONSTRAINT "claim_deadlines_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "holidays" ADD CONSTRAINT "holidays_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "report_executions" ADD CONSTRAINT "report_executions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "report_shares" ADD CONSTRAINT "report_shares_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "report_templates" ADD CONSTRAINT "report_templates_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "reports" ADD CONSTRAINT "reports_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "scheduled_reports" ADD CONSTRAINT "scheduled_reports_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "poll_votes" ADD CONSTRAINT "poll_votes_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "polls" ADD CONSTRAINT "polls_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "survey_answers" ADD CONSTRAINT "survey_answers_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "surveys" ADD CONSTRAINT "surveys_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "grievance_deadlines" ADD CONSTRAINT "grievance_deadlines_grievance_id_grievances_id_fk" FOREIGN KEY ("grievance_id") REFERENCES "public"."grievances"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "document_folders" ADD CONSTRAINT "document_folders_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "documents" ADD CONSTRAINT "documents_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "cookie_consents" ADD CONSTRAINT "cookie_consents_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "data_anonymization_log" ADD CONSTRAINT "data_anonymization_log_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "data_processing_records" ADD CONSTRAINT "data_processing_records_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "data_retention_policies" ADD CONSTRAINT "data_retention_policies_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "gdpr_data_requests" ADD CONSTRAINT "gdpr_data_requests_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "user_consents" ADD CONSTRAINT "user_consents_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_documents" ADD CONSTRAINT "signature_documents_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "signature_templates" ADD CONSTRAINT "signature_templates_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "chat_sessions" ADD CONSTRAINT "chat_sessions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "chatbot_analytics" ADD CONSTRAINT "chatbot_analytics_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "chatbot_suggestions" ADD CONSTRAINT "chatbot_suggestions_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "knowledge_base" ADD CONSTRAINT "knowledge_base_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "accessibility_audits" ADD CONSTRAINT "accessibility_audits_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "accessibility_issues" ADD CONSTRAINT "accessibility_issues_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "accessibility_test_suites" ADD CONSTRAINT "accessibility_test_suites_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "accessibility_user_testing" ADD CONSTRAINT "accessibility_user_testing_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "international_addresses" ADD CONSTRAINT "international_addresses_organization_id_organizations_id_fk" FOREIGN KEY ("organization_id") REFERENCES "public"."organizations"("id") ON DELETE cascade ON UPDATE no action;--> statement-breakpoint
CREATE INDEX "idx_webhook_log_status" ON "clc_webhook_log" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_webhook_log_received" ON "clc_webhook_log" USING btree ("received_at");--> statement-breakpoint
CREATE INDEX "idx_poll_votes_organization" ON "poll_votes" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_polls_organization" ON "polls" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_survey_answers_organization" ON "survey_answers" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_survey_questions_organization" ON "survey_questions" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_survey_responses_organization" ON "survey_responses" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_surveys_organization" ON "surveys" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_grievance_deadlines_grievance" ON "grievance_deadlines" USING btree ("grievance_id");--> statement-breakpoint
CREATE INDEX "idx_grievance_deadlines_due" ON "grievance_deadlines" USING btree ("due_date");--> statement-breakpoint
CREATE INDEX "idx_grievance_deadlines_status" ON "grievance_deadlines" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_automation_rules_status" ON "automation_rules" USING btree ("status");--> statement-breakpoint
CREATE INDEX "idx_automation_rules_target" ON "automation_rules" USING btree ("target_entity");--> statement-breakpoint
CREATE INDEX "idx_automation_rules_org" ON "automation_rules" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "idx_automation_rules_priority" ON "automation_rules" USING btree ("priority");--> statement-breakpoint
CREATE INDEX "idx_wallet_ledger_user" ON "reward_wallet_ledger" USING btree ("user_id");--> statement-breakpoint
CREATE INDEX "idx_wallet_ledger_type" ON "reward_wallet_ledger" USING btree ("transaction_type");--> statement-breakpoint
CREATE INDEX "idx_wallet_ledger_expires" ON "reward_wallet_ledger" USING btree ("expires_at");--> statement-breakpoint
CREATE INDEX "cookie_consents_organization_id_idx" ON "cookie_consents" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "anonymization_log_organization_id_idx" ON "data_anonymization_log" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "data_processing_organization_id_idx" ON "data_processing_records" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "retention_policies_organization_id_idx" ON "data_retention_policies" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "gdpr_requests_organization_id_idx" ON "gdpr_data_requests" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "user_consents_organization_id_idx" ON "user_consents" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "signature_documents_organization_id_idx" ON "signature_documents" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "signature_templates_organization_id_idx" ON "signature_templates" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "chat_sessions_organization_id_idx" ON "chat_sessions" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "chatbot_analytics_organization_id_idx" ON "chatbot_analytics" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "chatbot_suggestions_organization_id_idx" ON "chatbot_suggestions" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "knowledge_base_organization_id_idx" ON "knowledge_base" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "accessibility_audits_organization_id_idx" ON "accessibility_audits" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "accessibility_issues_organization_id_idx" ON "accessibility_issues" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "accessibility_test_suites_organization_id_idx" ON "accessibility_test_suites" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "accessibility_user_testing_organization_id_idx" ON "accessibility_user_testing" USING btree ("organization_id");--> statement-breakpoint
CREATE INDEX "international_addresses_organization_id_idx" ON "international_addresses" USING btree ("organization_id");--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "cba_number";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "language";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "employer_id";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "union_name";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "union_local";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "union_id";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "signed_date";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "ratification_date";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "industry_sector";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "sector";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "employee_coverage";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "bargaining_unit_description";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "document_hash";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "raw_text";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "structured_data";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "embedding";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "summary_generated";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "key_terms";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "ai_processed";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "is_public";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "view_count";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "created_by";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "last_modified_by";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "version";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "superseded_by";--> statement-breakpoint
ALTER TABLE "collective_agreements" DROP COLUMN "precedes_id";--> statement-breakpoint
ALTER TABLE "in_app_notifications" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "notification_bounces" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "notification_delivery_log" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "notification_history" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "notification_queue" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "notification_templates" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "notifications" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "user_notification_preferences" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "calendar_events" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "calendar_sharing" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "calendars" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "event_attendees" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "event_reminders" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "external_calendar_connections" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "meeting_rooms" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "room_bookings" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "deadline_alerts" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "deadline_extensions" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "deadline_rules" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "claim_deadlines" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "holidays" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "report_executions" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "report_shares" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "report_templates" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "reports" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "scheduled_reports" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "organization_id";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "affiliate_code";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "action";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "changes";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "conflicts";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "duration";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "error";--> statement-breakpoint
ALTER TABLE "clc_sync_log" DROP COLUMN "synced_at";--> statement-breakpoint
ALTER TABLE "poll_votes" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "polls" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "survey_answers" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "survey_questions" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "survey_responses" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "surveys" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "organization_id";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "claim_id";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "stage_id";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "deadline_date";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "deadline_time";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "timezone";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "priority";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "assigned_to";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "created_by";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "completed_by";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "calculated_from";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "contract_clause_reference";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "days_from_source";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "is_met";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "met_at";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "is_extended";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "extension_reason";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "extended_to";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "reminder_schedule";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "last_reminder_sent_at";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "escalate_on_miss";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "escalate_to";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "escalated_at";--> statement-breakpoint
ALTER TABLE "grievance_deadlines" DROP COLUMN "metadata";--> statement-breakpoint
ALTER TABLE "document_folders" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "documents" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "org_id";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "award_type_id";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "credit_amount";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "schedule";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "is_active";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "last_triggered_at";--> statement-breakpoint
ALTER TABLE "automation_rules" DROP COLUMN "trigger_count";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP COLUMN "org_id";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP COLUMN "event_type";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP COLUMN "amount_credits";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP COLUMN "source_type";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP COLUMN "source_id";--> statement-breakpoint
ALTER TABLE "reward_wallet_ledger" DROP COLUMN "memo";--> statement-breakpoint
ALTER TABLE "feature_flags" DROP COLUMN "allowed_tenants";--> statement-breakpoint
ALTER TABLE "cookie_consents" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "data_anonymization_log" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "data_processing_records" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "data_retention_policies" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "gdpr_data_requests" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "user_consents" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "signature_documents" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "signature_templates" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "chat_sessions" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "chatbot_analytics" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "chatbot_suggestions" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "knowledge_base" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "knowledge_base" DROP COLUMN "allowed_tenants";--> statement-breakpoint
ALTER TABLE "accessibility_audits" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "accessibility_issues" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "accessibility_test_suites" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "accessibility_user_testing" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "international_addresses" DROP COLUMN "tenant_id";--> statement-breakpoint
ALTER TABLE "clc_sync_log" ADD CONSTRAINT "clc_sync_log_sync_id_unique" UNIQUE("sync_id");--> statement-breakpoint
ALTER TABLE "clc_webhook_log" ADD CONSTRAINT "clc_webhook_log_webhook_id_unique" UNIQUE("webhook_id");--> statement-breakpoint
DROP TYPE IF EXISTS "public"."communication_channel" CASCADE;--> statement-breakpoint
DROP TYPE IF EXISTS "public"."award_status" CASCADE;--> statement-breakpoint
DROP SCHEMA "tenant_management";
